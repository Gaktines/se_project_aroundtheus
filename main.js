!function(){"use strict";class e{constructor(e){let{cardData:t,cardSelector:r,_handleCardClick:o,handleDeleteClick:s,processLikeClick:n,userId:i}=e;this._cardId=t._id,this._name=t.name,this._link=t.link,this._cardSelector=r,this._cardTemplateInput=document.querySelector("#card-template").content.firstElementChild,this._cardElement=this._cardTemplateInput.cloneNode(!0),this._handleCardClick=o,this._handleDeleteClick=s,this._userId=i,this._currentUserId=t.owner._id,this._processLikeClick=n,this._modalDeleteButton=document.querySelector("#modal-delete-btn"),this._likes=t.likes}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__button"),this._likeButton.addEventListener("click",(()=>{this._processLikeClick(this)})),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteClick(this._cardId)})),this._cardElement.querySelector("#card-image").addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link})))}setLikesInfo(e){this._likes=e,this._updateLikesView()}_updateLikesView(){this._cardElement.querySelector(".card__number").textContent=this._likes.length}handleModalDeleteButton(){this._cardElement.remove()}handleDeleteButton(){this._deleteBtn=this._cardElement.querySelector("#card-delete-button"),console.log(this._userId),this._currentUserId!=this._userId&&this._deleteBtn.remove()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCard(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector("#card-image").src=this._link,this._cardElement.querySelector("#card-name").textContent=this._name,this._cardElement.querySelector("#card-image").alt=this._name,this.handleDeleteButton(),this._setEventListeners(),this._updateLikesView(),this._cardElement}}class t{constructor(e,t){this._formSelector=".modal__form",this._inputSelector=".modal__input",this._submitButtonSelector=".modal__button",this._inactiveButtonClass="modal__button_disabled",this._inputErrorClass="modal__input_type_error",this._errorClass="modal__error_visible",this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._saveButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){console.log(`#${e.id}-error`),this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(e,t){if(this._hasInvalidInput())return this._saveButton.classList.add(this._inactiveButtonClass),void(this._saveButton.disabled=!0);this._saveButton.classList.remove(this._inactiveButtonClass),this._saveButton.disabled=!1}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e,t){let{items:r,renderer:o}=e;this.items=r,this.renderer=o,this._container=document.querySelector(t)}renderItems(){this.items.forEach(this.renderer)}addItem(e){this._container.prepend(e)}}class o{constructor(e){let{popupSelector:t}=e;this._modalElement=document.querySelector(t),this.modalCloseButton=this._modalElement.querySelector("#modal-close-button")}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{27===e.which&&this.close()};setEventListeners(){this._modalElement.addEventListener("click",this.closeModalOnRemoteClick)}closeModalOnRemoteClick=e=>{(e.target===e.currentTarget||e.target.classList.contains("modal__close"))&&this.close(e.target)}}class s extends o{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super({popupSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=r}_getInputValues(){const e={};return this._modalForm.querySelectorAll(".modal__input").forEach((t=>{const r=t.name,o=t.value;e[r]=o})),e}setLoading(e){const t=this._modalElement.querySelector(".modal__button");t.textContent=e?"Saving":t.textContent}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}open(){super.open()}close(){this._modalForm.reset(),super.close()}setSubmitAction(e){this._handleFormSubmit=e}}const n=document.querySelector("#profile-edit-button"),i=document.querySelector("#profile-edit-modal"),a=(document.querySelector("#profile-modal-close-button"),document.querySelector("#profile-title"),document.querySelector("#profile-subheading"),document.querySelector("#profile-modal-title")),l=document.querySelector("#modal-subheading"),d=(i.querySelector("#profile-modal-form"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#add-card-edit-modal")),c=(document.querySelector("#add-card-modal-close-button"),document.querySelector("#profile-add-button")),u=(document.querySelector("#add-card-modal-title"),document.querySelector("#add-card-link"),d.querySelector("#add-card-modal-form"),document.querySelector("#card-list"),document.querySelector("#modal-close-button"),document.querySelector("#modal-delete")),m={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},h=document.querySelector(".profile__image-button"),_=document.querySelector(".modal__button_save"),p=document.querySelector("#modal-profile-image"),S=new t(m,i),b=new t(m,d);S.enableValidation(),b.enableValidation();const g=new class{constructor(e){let{name:t,subheading:r}=e;this.name=document.querySelector(t),this.subheading=document.querySelector(r)}getUserInfo(){return{name:this.name.textContent,subheading:this.subheading.textContent}}setUserInfo(e){let{name:t,subheading:r}=e;this.name.textContent=t,this.subheading.textContent=r}}({name:".profile__title",subheading:".profile__subheading"}),E=new s({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){E.setLoading(!0),g.setUserInfo(e),E.setLoading(!1),E.close()}});E.setEventListeners();const f=new s({popupSelector:"#add-card-edit-modal",handleFormSubmit:function(e){f.setLoading(!0),I.addCard(e).then((e=>{f.setLoading(!1),C(e),f.close()}))}});f.setEventListeners();const v=new class extends o{constructor(e){let{popupSelector:t}=e;super({popupSelector:t})}open(e){const t=this._modalElement.querySelector("#modal-image");this._modalElement.querySelector("#modal-caption").textContent=e.name,t.src=e.link,t.alt=e.name,super.open()}}({popupSelector:"#image-modal"});v.setEventListeners();const k=new s({popupSelector:"#modal-delete",handleFormSubmit:()=>{}});k.setEventListeners();const L=new s({popupSelector:"#modal-profile-image",handleFormSubmit:q});function y(e){this._likeButton.classList.toggle("card__button_active"),isLiked?I.removeCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)})).catch((e=>{console.error(e)})):I.addCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)})).catch((e=>{console.error(e)}))}function C(t){const r=new e({cardData:t,cardSelector:"#card-template",_handleCardClick:e=>{let{name:t,link:r}=e;v.open({name:t,link:r})},handleDeleteClick:e=>{u.classList.add("modal_opened"),k.setSubmitAction((()=>{I.deleteCard(e).then((e=>{k.setLoading(!0),r.handleModalDeleteButton(),k.setLoading(!1),u.classList.remove("modal_opened")})).catch((e=>{console.error(e)}))}))},processLikeClick:y,userId:w});B.addItem(r.getCard())}function q(){L.setLoading(!0);const e=document.querySelector(".profile__image"),t=document.querySelector("#profile-image-link");e.src=t.value,L.setLoading(!1),L.close()}L.setEventListeners(),new t(m,p).enableValidation(),h.addEventListener("click",(()=>{L.open()})),_.addEventListener("click",(()=>{q()})),n.addEventListener("click",(()=>{const e=g.getUserInfo();a.value=e.name,l.value=e.subheading,E.open()})),c.addEventListener("click",(()=>{b.toggleButtonState(),f.open()}));const I=new class{constructor(e,t){this.name=e,this.link=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return this._request("https://around.nomoreparties.co/v1/group-12/cards",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}getUserInfo(){return this._request("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}})}updateUserInfo(e,t){return this._request("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}addCard(e){let{name:t,link:r}=e;return this._request("https://around.nomoreparties.co/v1/group-12/cards",{method:"POST",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})})}deleteCard(e){return this._request(`https://around.nomoreparties.co/v1/group-12/cards/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}handleDeleteButton(){this.deleteBtnModal=document.querySelector("#modal-delete"),this.deleteBtnModal.classList.add(".modal_opened")}handleCardLikes(){return Promise.all([this.addCardLike(),this.removeCardLike()])}addCardLike(e){return this._request(`https://around.nomoreparties.co/v1/group-12/cards/likes/${e}`,{method:"PUT",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}removeCardLike(e){return this._request(`https://around.nomoreparties.co/v1/groupId/cards/likes/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${JSON.stringify(e)}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}});let B,w;I.getAppInfo().then((e=>{let[t,o]=e;w=o._id,B=new r({items:t,renderer:C},".cards__list"),B.renderItems()})).catch((e=>{console.error(e)})),h.addEventListener("click",(()=>{L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNYQyxjQUFlLHlDQUdyQixDQUNBbkIsZUFBZTdGLEdBQ2IsT0FBTzFELEtBQUt1SyxTQUFVLDBEQUF5RDdHLElBQU0sQ0FDbkY4RyxPQUFRLFNBQ0pDLFFBQVMsQ0FDWEMsY0FBZSx5Q0FHckIsQ0FFQU8sZUFBZWxCLEdBRVgsT0FBSUEsRUFBSW1CLEdBQ0duQixFQUFJb0IsT0FFUmYsUUFBUWdCLE9BQVEsU0FBUU4sS0FBS0MsVUFBVWhCLEtBRWxELENBRUFRLFNBQVNjLEVBQUtoSCxHQUNaLE9BQU9pSCxNQUFNRCxFQUFLaEgsR0FBU3dFLEtBQUs3SSxLQUFLaUwsZUFDdkMsR0gwRmtCLENBQ2xCTSxRQUFTLDhDQUNUZCxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBSXBCLElBQUlWLEVBQ0FqSyxFQUVKNEksRUFBSXdCLGFBQWF0QixNQUFLTCxJQUF1QixJQUFyQmdELEVBQU9wRCxHQUFTSSxFQUN0Q3pJLEVBQVNxSSxFQUFTbEksSUFDbEI4SixFQUFVLElBQUlwRixFQUFRLENBQUVFLE1BQU8wRyxFQUFPekcsU0FBVStELEdBQWMsZ0JBQzlEa0IsRUFBUS9FLGFBQWEsSUFDcEJ3RSxPQUFPQyxJQUNSeEgsUUFBUXlILE1BQU1ELEVBQUksSUFRbEIzQixFQUFtQnRHLGlCQUFpQixTQUFTLEtBQzNDeUgsRUFBa0J6RCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BUEkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7XHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIF9oYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIHByb2Nlc3NMaWtlQ2xpY2ssXHJcbiAgICB1c2VySWRcclxuICAgIFxyXG4gIH0pIHtcclxuICAgIHRoaXMuX2NhcmRJZCA9IGNhcmREYXRhLl9pZDtcclxuICAgIHRoaXMuX25hbWUgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgdGhpcy5fbGluayA9IGNhcmREYXRhLmxpbms7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9jYXJkVGVtcGxhdGVJbnB1dCA9XHJcbiAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9jYXJkVGVtcGxhdGVJbnB1dC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBfaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcclxuICAgIC8vdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgdGhpcy5fdXNlcklkID0gdXNlcklkO1xyXG4gICAgdGhpcy5fY3VycmVudFVzZXJJZCA9IGNhcmREYXRhLm93bmVyLl9pZDtcclxuICAgIHRoaXMuX3Byb2Nlc3NMaWtlQ2xpY2sgPSBwcm9jZXNzTGlrZUNsaWNrO1xyXG4gICBcclxuICAgIHRoaXMuX21vZGFsRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGUtYnRuXCIpO1xyXG4gICAgdGhpcy5fbGlrZXMgPSBjYXJkRGF0YS5saWtlcztcclxuICAgIFxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9cIi5jYXJkX19idXR0b25cIlxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9wcm9jZXNzTGlrZUNsaWNrKHRoaXMpO1xyXG4gICAgICBcclxuICAgIH0pO1xyXG4gICAgLy9cIiNjYXJkLWRlbGV0ZS1idXR0b25cIlxyXG5cclxuICAgIHRoaXMuX2RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzLl9jYXJkSWQpO1xyXG4gICAgfSk7XHJcbiAgICAvL2ltYWdlXHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxyXG4gICAgICAucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlXCIpXHJcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT5cclxuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rIH0pXHJcbiAgICAgICk7XHJcbiAgICAvL1wiI21vZGFsLWRlbGV0ZS1idG5cIlxyXG4gIH1cclxuICBzZXRMaWtlc0luZm8obGlrZXMpIHtcclxuICAgIHRoaXMuX2xpa2VzID0gbGlrZXM7XHJcbiAgICB0aGlzLl91cGRhdGVMaWtlc1ZpZXcoKTtcclxuICB9XHJcbiAgX3VwZGF0ZUxpa2VzVmlldygpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbnVtYmVyXCIpLnRleHRDb250ZW50ID1cclxuICAgICAgdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG5cclxuICAgIC8vICB0aGF0IGVkaXRzIHRoZSAudGV4dENvbnRlbnQgb2YgdGhlIHNwYW4gd2l0aCB0aGUgbnVtYmVyXHJcbiAgICAvL2luIGl0IHRvIG1hdGNoIGhvdyBtYW55IHRoaXMuX2xpa2VzIHRoZXJlIGFyZSxcclxuICB9XHJcblxyXG4gIC8qX2hhbmRsZUxpa2VJY29uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnV0dG9uX2FjdGl2ZVwiKTtcclxuXHJcbiAgfTsqL1xyXG4gIC8qX2hhbmRsZURlbGV0ZUJ0bigpIHtcclxuICAgIGNvbnN0IGRlbGV0ZUJ0bk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGVcIik7XHJcbiAgICBkZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gIH0qL1xyXG4gIGhhbmRsZU1vZGFsRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcclxuICB9XHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fZGVsZXRlQnRuID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWRlbGV0ZS1idXR0b25cIik7XHJcbiAgICBjb25zb2xlLmxvZyh0aGlzLl91c2VySWQpO1xyXG4gICAgaWYgKHRoaXMuX2N1cnJlbnRVc2VySWQgIT0gdGhpcy5fdXNlcklkKSB7XHJcbiAgICAgIHRoaXMuX2RlbGV0ZUJ0bi5yZW1vdmUoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9nZXRUZW1wbGF0ZSgpIHtcclxuICAgIHJldHVybiBkb2N1bWVudFxyXG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXHJcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FyZCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcclxuICAgIC8vZ2V0IHRoZSBjYXJkIHZpZXdcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKS5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLW5hbWVcIikudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlXCIpLmFsdCA9IHRoaXMuX25hbWU7XHJcblxyXG4gICAgdGhpcy5oYW5kbGVEZWxldGVCdXR0b24oKTtcclxuICAgIC8vc2V0IHRoZSBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl91cGRhdGVMaWtlc1ZpZXcoKTtcclxuXHJcbiAgICAvL3JldHVybiB0aGUgY2FyZFxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gIH1cclxufVxyXG4vL191cGRhdGVMaWtlc1ZpZXcgaXMgY2FsbGVkIGluIGdldFZpZXcgKHdoaWNoIHJldHVybnMgdGhlIGNhcmRcclxuLy9IVE1MIGluaXRpYWxseSksIGFuZCBpbiBzZXRMaWtlc0luZm8gd2hpY2ggdXBkYXRlcyB0aGVcclxuLy90aGlzLl9saWtlcyBhcnJheSBiYXNlZCBvbiB0aGUgYXJndW1lbnRzIHBhc3NlZCBpbnRvIGl0XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xyXG4gIGNvbnN0cnVjdG9yKHZhbGlkYXRpb25PcHRpb25zLCBmb3JtRWxlbWVudCkge1xyXG4gICAgdGhpcy5fZm9ybVNlbGVjdG9yID0gXCIubW9kYWxfX2Zvcm1cIjtcclxuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBcIi5tb2RhbF9faW5wdXRcIjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gXCIubW9kYWxfX2J1dHRvblwiO1xyXG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiO1xyXG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiO1xyXG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIjtcclxuXHJcbiAgICB0aGlzLl9mb3JtID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG5cclxuICAgIHRoaXMuX3NhdmVCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2U7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnNvbGUubG9nKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuICB0b2dnbGVCdXR0b25TdGF0ZShzYXZlQnV0dG9uLCBvcHRpb25zKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xyXG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLml0ZW1zLmZvckVhY2godGhpcy5yZW5kZXJlcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLm1vZGFsQ2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIjbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgY29uc3QgRVNDX0tFWUNPREUgPSAyNztcclxuICAgIGlmIChldnQud2hpY2ggPT09IEVTQ19LRVlDT0RFKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gXHJcblxyXG4gIFxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlTW9kYWxPblJlbW90ZUNsaWNrKTtcclxuICB9XHJcbiAgY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2sgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0IHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5jbG9zZShldnQudGFyZ2V0KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGNvbnN0IGlucHV0cyA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBjb25zdCBuYW1lID0gaW5wdXQubmFtZTtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgaW5wdXRWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuICBzZXRMb2FkaW5nKGlzTG9hZGluZykge1xyXG4gICAgY29uc3QgbW9kYWxTdWJtaXRCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gICAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgICBtb2RhbFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nXCI7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBtb2RhbFN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9XHJcbiAgICAgICAgbW9kYWxTdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICB9XHJcbiAgfVxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9zdWJtaXQgZXZlbnRcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgdGhpcy5fbW9kYWxGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBzZXRTdWJtaXRBY3Rpb24oYWN0aW9uKSB7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gYWN0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XHJcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcclxuaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FQSS5qc1wiO1xyXG5cclxuLypjb25zdCBjYXJkRGF0YSA9IHtcclxuICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxyXG59OyovXHJcblxyXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBwcm9maWxlTW9kYWxDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjcHJvZmlsZS1tb2RhbC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBwcm9maWxlVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVTdWJoZWFkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXN1YmhlYWRpbmdcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsLXRpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlU3ViaGVhZGluZ0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1zdWJoZWFkaW5nXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1tb2RhbC1mb3JtXCIpO1xyXG5jb25zdCBjYXJkVGVtcGxhdGVJbnB1dCA9XHJcbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcblxyXG5jb25zdCBhZGRDYXJkRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1lZGl0LW1vZGFsXCIpO1xyXG5jb25zdCBhZGRDYXJkTW9kYWxDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgXCIjYWRkLWNhcmQtbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hZGQtYnV0dG9uXCIpO1xyXG5jb25zdCBhZGRDYXJkVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWwtdGl0bGVcIik7XHJcbmNvbnN0IGFkZENhcmRMaW5rSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWxpbmtcIik7XHJcblxyXG5jb25zdCBhZGRDYXJkRm9ybSA9IGFkZENhcmRFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbC1mb3JtXCIpO1xyXG5jb25zdCBjYXJkc1dyYXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtbGlzdFwiKTtcclxuXHJcbmNvbnN0IGltYWdlTW9kYWxDbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2xvc2UtYnV0dG9uXCIpO1xyXG5jb25zdCBkZWxldGVCdG5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG5jb25zdCB2YWxpZGF0aW9uT3B0aW9ucyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXHJcbn07XHJcbmNvbnN0IHByb2ZpbGVJbWFnZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2UtYnV0dG9uXCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZUltYWdlU2F2ZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvbl9zYXZlXCIpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXByb2ZpbGUtaW1hZ2VcIik7XHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbk9wdGlvbnMsXHJcbiAgcHJvZmlsZUVkaXRNb2RhbFxyXG4pO1xyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gIGFkZENhcmRFZGl0TW9kYWxcclxuKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgc3ViaGVhZGluZzogXCIucHJvZmlsZV9fc3ViaGVhZGluZ1wiLFxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVFZGl0TW9kYWxGb3JtU3VibWl0LFxyXG59KTtcclxuZWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQsXHJcbn0pO1xyXG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjaW1hZ2UtbW9kYWxcIixcclxufSk7XHJcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgY2FyZERlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI21vZGFsLWRlbGV0ZVwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHt9LFxyXG59KTtcclxuY2FyZERlbGV0ZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI21vZGFsLXByb2ZpbGUtaW1hZ2VcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVQcm9maWxlSW1hZ2VGb3JtLFxyXG59KTtcclxucHJvZmlsZUltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgcHJvZmlsZUltYWdlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbk9wdGlvbnMsXHJcbiAgcHJvZmlsZUltYWdlXHJcbik7XHJcbnByb2ZpbGVJbWFnZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbnByb2ZpbGVJbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHByb2ZpbGVJbWFnZU1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5wcm9maWxlSW1hZ2VTYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgaGFuZGxlUHJvZmlsZUltYWdlRm9ybSgpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHByb2Nlc3NMaWtlQ2xpY2soY2FyZCkge1xyXG4gIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2J1dHRvbl9hY3RpdmVcIik7XHJcbiAgaWYgKGlzTGlrZWQpIHtcclxuICAgIGFwaS5yZW1vdmVDYXJkTGlrZShjYXJkLl9jYXJkSWQpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY2FyZC5zZXRMaWtlc0luZm8oZGF0YS5saWtlcyk7XHJcbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGkuYWRkQ2FyZExpa2UoY2FyZC5fY2FyZElkKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmQuc2V0TGlrZXNJbmZvKGRhdGEubGlrZXMpO1xyXG4gICAgfSkuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgX2hhbmRsZUNhcmRDbGljazogKHsgbmFtZSwgbGluayB9KSA9PiB7XHJcbiAgICAgIC8vaGVyZSBpcyB3aGVyZSB3ZSB3YW50IHRvIG9wZW4gb3VyIHBvcHVwV2l0aEltYWdlIGluc3RhbmNlLlxyXG4gICAgICBpbWFnZU1vZGFsLm9wZW4oeyBuYW1lLCBsaW5rIH0pO1xyXG4gICAgfSxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrOiAoY2FyZElkKSA9PiB7XHJcbiAgICAgIC8vIG9wZW4gdGhlIG1vZGFsXHJcbiAgICAgIG9wZW5EZWxldGVNb2RhbCgpO1xyXG4gICAgICAvLyBzZXQgYSBzdWJtaXQgYWN0aW9uXHJcbiAgICAgIGNhcmREZWxldGVNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGFwaS5kZWxldGVDYXJkKGNhcmRJZCkudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgICBjYXJkRGVsZXRlTW9kYWwuc2V0TG9hZGluZyh0cnVlKTtcclxuICAgICAgICAgIGNhcmQuaGFuZGxlTW9kYWxEZWxldGVCdXR0b24oKTtcclxuICAgICAgICAgIGNhcmREZWxldGVNb2RhbC5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICAgICAgICAgIGNsb3NlRGVsZXRlTW9kYWwoKTtcclxuICAgICAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIHByb2Nlc3NMaWtlQ2xpY2ssXHJcblxyXG4gICAgdXNlcklkLFxyXG4gIH0pO1xyXG5cclxuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZC5nZXRDYXJkKCkpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRNb2RhbEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBlZGl0TW9kYWwuc2V0TG9hZGluZyh0cnVlKTtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcyk7XHJcbiAgZWRpdE1vZGFsLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gIGVkaXRNb2RhbC5jbG9zZSgpO1xyXG4gIFxyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGNhcmREYXRhKSB7XHJcbiAgYWRkQ2FyZE1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpLmFkZENhcmQoY2FyZERhdGEpLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICBhZGRDYXJkTW9kYWwuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgIGFkZENhcmRNb2RhbC5jbG9zZSgpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVByb2ZpbGVJbWFnZUZvcm0oKSB7XHJcbiAgLy9ldnQucHJldmVudERlZmF1bHQoKTtcclxuICBwcm9maWxlSW1hZ2VNb2RhbC5zZXRMb2FkaW5nKHRydWUpO1xyXG4gIGNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbiAgY29uc3QgcHJvZmlsZUltYWdlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtaW1hZ2UtbGlua1wiKTtcclxuICBwcm9maWxlSW1hZ2Uuc3JjID0gcHJvZmlsZUltYWdlSW5wdXQudmFsdWU7XHJcbiAgcHJvZmlsZUltYWdlTW9kYWwuc2V0TG9hZGluZyhmYWxzZSk7XHJcblxyXG4gIHByb2ZpbGVJbWFnZU1vZGFsLmNsb3NlKCk7XHJcbn1cclxuXHJcblxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVTdWJoZWFkaW5nSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5zdWJoZWFkaW5nO1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7Ly8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG5cclxubGV0IHNlY3Rpb247XHJcbmxldCB1c2VySWQ7XHJcblxyXG5hcGkuZ2V0QXBwSW5mbygpLnRoZW4oKFtjYXJkcywgdXNlckluZm9dKSA9PiB7XHJcbiAgdXNlcklkID0gdXNlckluZm8uX2lkO1xyXG4gIHNlY3Rpb24gPSBuZXcgU2VjdGlvbih7IGl0ZW1zOiBjYXJkcywgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSwgXCIuY2FyZHNfX2xpc3RcIik7XHJcbiAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG59KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgY29uc29sZS5lcnJvcihlcnIpO1xyXG59KTtcclxuXHJcbm9wZW5Qcm9maWxlSW1hZ2VNb2RhbCgpO1xyXG5cclxuXHJcblxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZUltYWdlTW9kYWwoKSB7XHJcbiAgcHJvZmlsZUltYWdlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBwcm9maWxlSW1hZ2VNb2RhbC5vcGVuKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5EZWxldGVNb2RhbCgpIHtcclxuICBkZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZURlbGV0ZU1vZGFsKCkge1xyXG4gIGRlbGV0ZUJ0bk1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgc3ViaGVhZGluZyB9KSB7XHJcbiAgICB0aGlzLm5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5zdWJoZWFkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdWJoZWFkaW5nKTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAvLyByZXR1cm4gdGhlIHRleHQgcHJvcGVydGllcyBvZiB0aGlzLm5hbWUgYW5kIHRoaXMuam9iXHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLm5hbWUudGV4dENvbnRlbnQsIHN1YmhlYWRpbmc6IHRoaXMuc3ViaGVhZGluZy50ZXh0Q29udGVudCB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIHN1YmhlYWRpbmcgfSkge1xyXG4gICAgLy8gV2hlbiBmb3JtIGlzIHN1Ym1pdHRlZCwgc2V0IHRoZSBwcm9maWxlIGluZm9cclxuICAgIHRoaXMubmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLnN1YmhlYWRpbmcudGV4dENvbnRlbnQgPSBzdWJoZWFkaW5nO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICB9XHJcbiAgb3BlbihjYXJkRGF0YSkge1xyXG4gICAgY29uc3QgaW1hZ2VNb2RhbENhcmQgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbWFnZVwiKTtcclxuICAgIGNvbnN0IGltYWdlTW9kYWxDYXB0aW9uID1cclxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2FwdGlvblwiKTtcclxuXHJcbiAgICAvKkluIHRoZSBvcGVuKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhJbWFnZSBjbGFzcywgXHJcbiAgICB5b3UgbmVlZCB0byBhZGQgYW4gaW1hZ2UgdG8gdGhlIHBvcHVwIGFuZCB0aGUgXHJcbiAgICBjb3JyZXNwb25kaW5nIGltYWdlIHNyYyBhdHRyaWJ1dGUgYWxvbmcgd2l0aCBhIFxyXG4gICAgY2FwdGlvbiBmb3IgdGhlIGltYWdlLiovXHJcbiAgICBpbWFnZU1vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBpbWFnZU1vZGFsQ2FyZC5zcmMgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgaW1hZ2VNb2RhbENhcmQuYWx0ID0gY2FyZERhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiLypmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIiwge1xyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCJcclxuICB9XHJcbn0pXHJcbiAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTsqL1xyXG5cclxuICBleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgbGluaykge1xyXG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICB0aGlzLmxpbmsgPSBsaW5rO1xyXG4gICAgfVxyXG4gICAgZ2V0QXBwSW5mbygpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkc1wiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiXHJcbiAgICAgICAgfX0pO1xyXG4gICAgICAgIFxyXG59XHJcblxyXG4gICAgXHJcbiAgICBcclxuICBnZXRVc2VySW5mbygpIHtcclxuIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgICB9fSk7XHJcbiAgfVxyXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XHJcbiAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi91c2Vycy9tZVwiLCB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJ9LFxyXG4gICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgbmFtZSxcclxuICAgICAgICAgICAgYWJvdXRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgYWRkQ2FyZCh7bmFtZSwgbGlua30pIHtcclxuXHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHNcIiwge1xyXG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIn0sXHJcbiAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICBuYW1lLFxyXG4gICAgICAgICAgICBsaW5rXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSk7XHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIixcclxuICAgICAgfX0pO1xyXG4gICAgICBcclxuICB9XHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICB9XHJcbiAgaGFuZGxlQ2FyZExpa2VzKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmFkZENhcmRMaWtlKCksIHRoaXMucmVtb3ZlQ2FyZExpa2UoKV0pXHJcbiAgfVxyXG4gIGFkZENhcmRMaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgIH19KTtcclxuICAgICAgICBcclxuICB9XHJcbiAgcmVtb3ZlQ2FyZExpa2UoaWQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICB9fSk7XHJcbiAgICBcclxuICB9XHJcbiAgICAvLyBvdGhlciBtZXRob2RzIGZvciB3b3JraW5nIHdpdGggdGhlIEFQSVxyXG4gIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgXHJcbiAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3IgJHtKU09OLnN0cmluZ2lmeShyZXMpfWApO1xyXG4gIFxyXG4gIH1cclxuICBcclxuICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XHJcbiAgfVxyXG4gXHJcbn1cclxuICAiXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwicHJvY2Vzc0xpa2VDbGljayIsInVzZXJJZCIsInRoaXMiLCJfY2FyZElkIiwiX2lkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9jYXJkVGVtcGxhdGVJbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIl9jYXJkRWxlbWVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVEZWxldGVDbGljayIsIl91c2VySWQiLCJfY3VycmVudFVzZXJJZCIsIm93bmVyIiwiX3Byb2Nlc3NMaWtlQ2xpY2siLCJfbW9kYWxEZWxldGVCdXR0b24iLCJfbGlrZXMiLCJsaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdG4iLCJzZXRMaWtlc0luZm8iLCJfdXBkYXRlTGlrZXNWaWV3IiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJoYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbiIsInJlbW92ZSIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImNvbnNvbGUiLCJsb2ciLCJfZ2V0VGVtcGxhdGUiLCJnZXRDYXJkIiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInZhbGlkYXRpb25PcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2F2ZUJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsIl9lcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJjbGFzc0xpc3QiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsInNhdmVCdXR0b24iLCJvcHRpb25zIiwiZGlzYWJsZWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJjb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIm1vZGFsQ2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2hpY2giLCJzZXRFdmVudExpc3RlbmVycyIsImNsb3NlTW9kYWxPblJlbW90ZUNsaWNrIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInNldExvYWRpbmciLCJpc0xvYWRpbmciLCJtb2RhbFN1Ym1pdEJ1dHRvbiIsInJlc2V0Iiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlU3ViaGVhZGluZ0lucHV0IiwiYWRkQ2FyZEVkaXRNb2RhbCIsImFkZENhcmRCdXR0b24iLCJkZWxldGVCdG5Nb2RhbCIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwicHJvZmlsZUltYWdlQnV0dG9uIiwicHJvZmlsZUltYWdlU2F2ZUJ1dHRvbiIsInByb2ZpbGVJbWFnZSIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkQ2FyZEZvcm1WYWxpZGF0b3IiLCJ1c2VySW5mbyIsInN1YmhlYWRpbmciLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJlZGl0TW9kYWwiLCJhZGRDYXJkTW9kYWwiLCJhcGkiLCJhZGRDYXJkIiwidGhlbiIsInJlbmRlckNhcmQiLCJpbWFnZU1vZGFsIiwiaW1hZ2VNb2RhbENhcmQiLCJjYXJkRGVsZXRlTW9kYWwiLCJwcm9maWxlSW1hZ2VNb2RhbCIsImhhbmRsZVByb2ZpbGVJbWFnZUZvcm0iLCJjYXJkIiwidG9nZ2xlIiwiaXNMaWtlZCIsInJlbW92ZUNhcmRMaWtlIiwiZGF0YSIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJhZGRDYXJkTGlrZSIsImNhcmRJZCIsImRlbGV0ZUNhcmQiLCJyZXMiLCJzZWN0aW9uIiwicHJvZmlsZUltYWdlSW5wdXQiLCJwcm9maWxlRGF0YSIsImdldEFwcEluZm8iLCJQcm9taXNlIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiX3JlcXVlc3QiLCJtZXRob2QiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInVwZGF0ZVVzZXJJbmZvIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImhhbmRsZUNhcmRMaWtlcyIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwicmVqZWN0IiwidXJsIiwiZmV0Y2giLCJiYXNlVXJsIiwiY2FyZHMiXSwic291cmNlUm9vdCI6IiJ9