!function(){"use strict";class e{constructor(e){let{cardData:t,cardSelector:r,handleCardClick:o}=e;this._name=t.name,this._link=t.link,this._cardSelector=r,this._cardTemplateInput=document.querySelector("#card-template").content.firstElementChild,this._cardElement=this._cardTemplateInput.cloneNode(!0),this._handleCardClick=o,this._modalDeleteButton=document.querySelector("#modal-delete-btn"),this.likes=[]}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__button"),this._likeButton.addEventListener("click",(()=>{this._handleLikeIcon()})),this._deleteBtn=this._cardElement.querySelector("#card-delete-button"),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteBtn()})),this._cardElement.querySelector("#card-image").addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link}))),this._modalDeleteButton.addEventListener("click",(()=>{handleModalDeleteButton()}))}setLikesInfo(){this._likeButton.addEventListener("click",(()=>(this.likes=this.likes+1,this.likes)))}_updateLikesView(){this._cardElement.querySelector(".card__number").textContent=this.likes.length}_handleLikeIcon=()=>{this._likeButton.classList.toggle("card__button_active")};_handleDeleteBtn(){document.querySelector("#modal-delete").classList.add(".modal_opened")}handleModalDeleteButton(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCard(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector("#card-image").src=this._link,this._cardElement.querySelector("#card-name").textContent=this._name,this._cardElement.querySelector("#card-image").alt=this._name,this._setEventListeners(),this._updateLikesView(),this.setLikesInfo(),this._cardElement}}class t{constructor(e,t){this._formSelector=".modal__form",this._inputSelector=".modal__input",this._submitButtonSelector=".modal__button",this._inactiveButtonClass="modal__button_disabled",this._inputErrorClass="modal__input_type_error",this._errorClass="modal__error_visible",this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._saveButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(e,t){if(this._hasInvalidInput())return this._saveButton.classList.add(this._inactiveButtonClass),void(this._saveButton.disabled=!0);this._saveButton.classList.remove(this._inactiveButtonClass),this._saveButton.disabled=!1}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e,t){let{items:r,renderer:o}=e;this.items=r,this.renderer=o,this._container=document.querySelector(t)}renderItems(){this.items.forEach(this.renderer)}addItem(e){this._container.prepend(e)}}class o{constructor(e){let{popupSelector:t}=e;this._modalElement=document.querySelector(t),this.modalCloseButton=this._modalElement.querySelector("#modal-close-button")}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{27===e.which&&this.close()};setEventListeners(){this._modalElement.addEventListener("click",this.closeModalOnRemoteClick)}closeModalOnRemoteClick=e=>{(e.target===e.currentTarget||e.target.classList.contains("modal__close"))&&this.close(e.target)}}class s extends o{constructor(e){let{popupSelector:t,handleFormSubmit:r}=e;super({popupSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=r}_getInputValues(){const e={};return this._modalForm.querySelectorAll(".modal__input").forEach((t=>{const r=t.name,o=t.value;e[r]=o})),e}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}open(){super.open()}close(){this._modalForm.reset(),super.close()}}const n=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),i=(document.querySelector("#profile-modal-close-button"),document.querySelector("#profile-title"),document.querySelector("#profile-subheading"),document.querySelector("#profile-modal-title")),l=document.querySelector("#modal-subheading"),d=(a.querySelector("#profile-modal-form"),document.querySelector("#card-template").content.firstElementChild),c=document.querySelector("#add-card-edit-modal"),u=(document.querySelector("#add-card-modal-close-button"),document.querySelector("#profile-add-button")),h=(document.querySelector("#add-card-modal-title"),document.querySelector("#add-card-link"),c.querySelector("#add-card-modal-form"),document.querySelector("#card-list"),document.querySelector("#modal-close-button"),{formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}),m=new t(h,a),_=new t(h,c);m.enableValidation(),_.enableValidation();const p=new class{constructor(e){let{name:t,subheading:r}=e;this.name=document.querySelector(t),this.subheading=document.querySelector(r)}getUserInfo(){return{name:this.name.textContent,subheading:this.subheading.textContent}}setUserInfo(e){let{name:t,subheading:r}=e;this.name.textContent=t,this.subheading.textContent=r}}({name:".profile__title",subheading:".profile__subheading"}),S=new s({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){p.setUserInfo(e),S.close()}});S.setEventListeners();const b=new s({popupSelector:"#add-card-edit-modal",handleFormSubmit:function(e){E(e),b.close()}});b.setEventListeners();const f=new class extends o{constructor(e){let{popupSelector:t}=e;super({popupSelector:t})}open(e){const t=this._modalElement.querySelector("#modal-image");this._modalElement.querySelector("#modal-caption").textContent=e.name,t.src=e.link,t.alt=e.name,super.open()}}({popupSelector:"#image-modal"});function E(t){const r=new e({cardData:t,cardSelector:"#card-template",handleCardClick:e=>{let{name:t,link:r}=e;f.open({name:t,link:r})}});y.addItem(r.getCard())}f.setEventListeners(),d.cloneNode(!0).querySelector("#card-image"),n.addEventListener("click",(()=>{const e=p.getUserInfo();i.value=e.name,l.value=e.subheading,S.open()})),u.addEventListener("click",(()=>{_.toggleButtonState(),b.open()}));const v=new class{constructor(e,t){this.name=e,this.link=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch("https://around.nomoreparties.co/v1/group-12/cards",{method:"Get",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json())).catch((e=>{console.error(e)}))}getUserInfo(){return fetch("https://around.nomoreparties.co/v1/group-12/users/me",{method:"PATCH",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:"Marie SkÅ‚odowska Curie",about:"Physicist and Chemist"})})}addCard(){return fetch("https://around.nomoreparties.co/v1/groupId/cards",{method:"Post",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}}).then((e=>e.json()))}deleteCard(){return{method:"Delete",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}.then((()=>deleteCard)),!0}addCardLike(){return fetch("https://around.nomoreparties.co/v1/group-12/cards/likes/cardId ",{method:"Put",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json()))}removeCardLike(){return fetch("https://around.nomoreparties.co/v1/groupId/cards/likes/cardId",{method:"Delete",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json()))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}});let y;v.getAppInfo().then((e=>{let[t,o]=e;y=new r({items:t,renderer:E},".cards__list"),y.renderItems()})),v.deleteCard()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQU1ZLGNBTlAsQ0FRUixDQUNBQyxjQUNDLE9BQU9qQixNQUFNLGtFQUFtRSxDQUM3RUMsT0FBUSxNQUNSQyxRQUFTLENBQ0xDLGNBQWUsMENBR2hCQyxNQUFLQyxHQUFPQSxFQUFJQyxRQUV2QixDQUNBWSxpQkFDRSxPQUFPbEIsTUFBTSxnRUFBaUUsQ0FDNUVDLE9BQVEsU0FDUkMsUUFBUyxDQUNMQyxjQUFlLDBDQUdwQkMsTUFBS0MsR0FBT0EsRUFBSUMsUUFDbkIsR0hpRW9CLENBQ2xCYSxRQUFTLDhDQUNUakIsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLHNCQUd0QixJQUFJVixFQUVKRSxFQUFJQyxhQUFhUSxNQUFLbEIsSUFBdUIsSUFBckJrQyxFQUFPdEMsR0FBU0ksRUFDdENPLEVBQVUsSUFBSTNELEVBQ1osQ0FBRUUsTUFBT29GLEVBQU9uRixTQUFVb0QsR0FDMUIsZ0JBRUZJLEVBQVF0RCxhQUFhLElBS3ZCd0QsRUFBSXFCLFkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BUEkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgY29uc3RydWN0b3IoeyBjYXJkRGF0YSwgY2FyZFNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2sgfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0LmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcclxuICAgIHRoaXMuX21vZGFsRGVsZXRlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGUtYnRuXCIpO1xyXG4gICAgdGhpcy5saWtlcyA9IFtdO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9cIi5jYXJkX19idXR0b25cIlxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlSWNvbigpO1xyXG4gICAgfSk7XHJcbiAgICAvL1wiI2NhcmQtZGVsZXRlLWJ1dHRvblwiXHJcbiAgICB0aGlzLl9kZWxldGVCdG4gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtZGVsZXRlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVCdG4oKTtcclxuICAgIH0pO1xyXG4gICAgLy9pbWFnZVxyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKVxyXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KVxyXG4gICAgICApO1xyXG4gICAgLy9cIiNtb2RhbC1kZWxldGUtYnRuXCJcclxuICAgIHRoaXMuX21vZGFsRGVsZXRlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIGhhbmRsZU1vZGFsRGVsZXRlQnV0dG9uKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbiAgc2V0TGlrZXNJbmZvKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLmxpa2VzID0gdGhpcy5saWtlcyArIDE7XHJcbiAgICAgIHJldHVybiB0aGlzLmxpa2VzO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIF91cGRhdGVMaWtlc1ZpZXcoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX251bWJlclwiKS50ZXh0Q29udGVudCA9IHRoaXMubGlrZXMubGVuZ3RoO1xyXG4gICAgXHJcbiAgICAvLyAgdGhhdCBlZGl0cyB0aGUgLnRleHRDb250ZW50IG9mIHRoZSBzcGFuIHdpdGggdGhlIG51bWJlclxyXG4gICAgLy9pbiBpdCB0byBtYXRjaCBob3cgbWFueSB0aGlzLl9saWtlcyB0aGVyZSBhcmUsXHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUljb24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19idXR0b25fYWN0aXZlXCIpO1xyXG4gICAgXHJcbiAgfTtcclxuICBfaGFuZGxlRGVsZXRlQnRuKCkge1xyXG4gICAgY29uc3QgZGVsZXRlQnRuTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWRlbGV0ZVwiKTtcclxuICAgIGRlbGV0ZUJ0bk1vZGFsLmNsYXNzTGlzdC5hZGQoXCIubW9kYWxfb3BlbmVkXCIpO1xyXG4gIH1cclxuICBoYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRDYXJkKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgLy9nZXQgdGhlIGNhcmQgdmlld1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlXCIpLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtbmFtZVwiKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIikuYWx0ID0gdGhpcy5fbmFtZTtcclxuICAgIC8vc2V0IHRoZSBldmVudCBsaXN0ZW5lcnNcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl91cGRhdGVMaWtlc1ZpZXcoKTtcclxuICAgIHRoaXMuc2V0TGlrZXNJbmZvKCk7XHJcbiAgICAvL3JldHVybiB0aGUgY2FyZFxyXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xyXG4gICAgXHJcbiAgfVxyXG4gIFxyXG59XHJcbi8vX3VwZGF0ZUxpa2VzVmlldyBpcyBjYWxsZWQgaW4gZ2V0VmlldyAod2hpY2ggcmV0dXJucyB0aGUgY2FyZFxyXG4vL0hUTUwgaW5pdGlhbGx5KSwgYW5kIGluIHNldExpa2VzSW5mbyB3aGljaCB1cGRhdGVzIHRoZVxyXG4vL3RoaXMuX2xpa2VzIGFycmF5IGJhc2VkIG9uIHRoZSBhcmd1bWVudHMgcGFzc2VkIGludG8gaXRcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvbk9wdGlvbnMsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9mb3JtU2VsZWN0b3IgPSBcIi5tb2RhbF9fZm9ybVwiO1xyXG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IFwiLm1vZGFsX19pbnB1dFwiO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBcIi5tb2RhbF9fYnV0dG9uXCI7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCI7XHJcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCI7XHJcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuXHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBBcnJheS5mcm9tKFxyXG4gICAgICB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoXHJcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgKTtcclxuICB9XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoc2F2ZUJ1dHRvbiwgb3B0aW9ucykge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKHRoaXMucmVuZGVyZXIpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5tb2RhbENsb3NlQnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGNvbnN0IEVTQ19LRVlDT0RFID0gMjc7XHJcbiAgICBpZiAoZXZ0LndoaWNoID09PSBFU0NfS0VZQ09ERSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuIFxyXG5cclxuICBcclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZU1vZGFsT25SZW1vdGVDbGljayk7XHJcbiAgfVxyXG4gIGNsb3NlTW9kYWxPblJlbW90ZUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKFxyXG4gICAgICBldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fFxyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZ0LnRhcmdldCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgY29uc3QgbmFtZSA9IGlucHV0Lm5hbWU7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgIGlucHV0VmFsdWVzW25hbWVdID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL3N1Ym1pdCBldmVudFxyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuXHJcbiAgICB0aGlzLl9tb2RhbEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgc3VwZXIub3BlbigpO1xyXG4gIH1cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX21vZGFsRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICAgXHJcbiAgICBcclxuXHJcbiAgICBcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BUEkuanNcIjtcclxuXHJcbmNvbnN0IGluaXRpYWxDYXJkcyA9IFtcclxuICB7XHJcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2JhbGQtbW91bnRhaW5zLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYXRlbWFyXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcclxuICB9LFxyXG4gIHtcclxuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZyBcIixcclxuICB9LFxyXG5dO1xyXG5jb25zdCBjYXJkRGF0YSA9IHtcclxuICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXHJcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnIFwiLFxyXG59O1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlU3ViaGVhZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1zdWJoZWFkaW5nXCIpO1xyXG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1tb2RhbC10aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZVN1YmhlYWRpbmdJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtc3ViaGVhZGluZ1wiKTtcclxuY29uc3QgcHJvZmlsZUVkaXRGb3JtID0gcHJvZmlsZUVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlSW5wdXQgPVxyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC10ZW1wbGF0ZVwiKS5jb250ZW50LmZpcnN0RWxlbWVudENoaWxkO1xyXG5cclxuY29uc3QgYWRkQ2FyZEVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgYWRkQ2FyZE1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI2FkZC1jYXJkLW1vZGFsLWNsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWRkLWJ1dHRvblwiKTtcclxuY29uc3QgYWRkQ2FyZFRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsLXRpdGxlXCIpO1xyXG5jb25zdCBhZGRDYXJkTGlua0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rXCIpO1xyXG5cclxuY29uc3QgYWRkQ2FyZEZvcm0gPSBhZGRDYXJkRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWwtZm9ybVwiKTtcclxuY29uc3QgY2FyZHNXcmFwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWxpc3RcIik7XHJcblxyXG5jb25zdCBpbWFnZU1vZGFsQ2xvc2VCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiKTtcclxuXHJcbmNvbnN0IHZhbGlkYXRpb25PcHRpb25zID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbk9wdGlvbnMsXHJcbiAgcHJvZmlsZUVkaXRNb2RhbFxyXG4pO1xyXG5jb25zdCBhZGRDYXJkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gIGFkZENhcmRFZGl0TW9kYWxcclxuKTtcclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBzdWJoZWFkaW5nOiBcIi5wcm9maWxlX19zdWJoZWFkaW5nXCIsXHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZUVkaXRNb2RhbEZvcm1TdWJtaXQsXHJcbn0pO1xyXG5lZGl0TW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1jYXJkLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdCxcclxufSk7XHJcbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBpbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNpbWFnZS1tb2RhbFwiLFxyXG59KTtcclxuaW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZCh7XHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcjogXCIjY2FyZC10ZW1wbGF0ZVwiLFxyXG4gICAgaGFuZGxlQ2FyZENsaWNrOiAoeyBuYW1lLCBsaW5rIH0pID0+IHtcclxuICAgICAgLy9oZXJlIGlzIHdoZXJlIHdlIHdhbnQgdG8gb3BlbiBvdXIgcG9wdXBXaXRoSW1hZ2UgaW5zdGFuY2UuXHJcbiAgICAgIGltYWdlTW9kYWwub3Blbih7IG5hbWUsIGxpbmsgfSk7XHJcbiAgICB9LFxyXG4gIH0pO1xyXG5cclxuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZC5nZXRDYXJkKCkpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRNb2RhbEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcyk7XHJcbiAgZWRpdE1vZGFsLmNsb3NlKCk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICByZW5kZXJDYXJkKGlucHV0VmFsdWVzKTtcclxuICBhZGRDYXJkTW9kYWwuY2xvc2UoKTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRGb3JtKGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHByb2ZpbGVUaXRsZS50ZXh0Q29udGVudCA9IHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlO1xyXG4gIHByb2ZpbGVTdWJoZWFkaW5nLnRleHRDb250ZW50ID0gcHJvZmlsZVN1YmhlYWRpbmdJbnB1dC52YWx1ZTtcclxufVxyXG5cclxuXHJcbmNvbnN0IGNhcmRFbGVtZW50ID0gY2FyZFRlbXBsYXRlSW5wdXQuY2xvbmVOb2RlKHRydWUpO1xyXG5cclxuY29uc3QgY2FyZEltYWdlRWxlbWVudCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKTtcclxuXHJcbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc3QgcHJvZmlsZURhdGEgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xyXG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gcHJvZmlsZURhdGEubmFtZTtcclxuICBwcm9maWxlU3ViaGVhZGluZ0lucHV0LnZhbHVlID0gcHJvZmlsZURhdGEuc3ViaGVhZGluZztcclxuICBlZGl0TW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmFkZENhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkRm9ybVZhbGlkYXRvci50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gIGFkZENhcmRNb2RhbC5vcGVuKClcclxufSk7IFxyXG5cclxuXHJcbiAgY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIixcclxuICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgIH1cclxuICB9KTsgXHJcbmxldCBzZWN0aW9uO1xyXG5cclxuYXBpLmdldEFwcEluZm8oKS50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcclxuICAgIHsgaXRlbXM6IGNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gICAgXCIuY2FyZHNfX2xpc3RcIlxyXG4gICk7XHJcbiAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gIFxyXG59KTtcclxuXHJcblxyXG5hcGkuZGVsZXRlQ2FyZCgpO1xyXG4vL2FwaS5jYXJkTGlrZSgpOyIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIHN1YmhlYWRpbmcgfSkge1xyXG4gICAgdGhpcy5uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lKTtcclxuICAgIHRoaXMuc3ViaGVhZGluZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioc3ViaGVhZGluZyk7XHJcbiAgfVxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgLy8gcmV0dXJuIHRoZSB0ZXh0IHByb3BlcnRpZXMgb2YgdGhpcy5uYW1lIGFuZCB0aGlzLmpvYlxyXG4gICAgcmV0dXJuIHsgbmFtZTogdGhpcy5uYW1lLnRleHRDb250ZW50LCBzdWJoZWFkaW5nOiB0aGlzLnN1YmhlYWRpbmcudGV4dENvbnRlbnQgfTtcclxuICB9XHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBzdWJoZWFkaW5nIH0pIHtcclxuICAgIC8vIFdoZW4gZm9ybSBpcyBzdWJtaXR0ZWQsIHNldCB0aGUgcHJvZmlsZSBpbmZvXHJcbiAgICB0aGlzLm5hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5zdWJoZWFkaW5nLnRleHRDb250ZW50ID0gc3ViaGVhZGluZztcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgfVxyXG4gIG9wZW4oY2FyZERhdGEpIHtcclxuICAgIGNvbnN0IGltYWdlTW9kYWxDYXJkID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW1hZ2VcIik7XHJcbiAgICBjb25zdCBpbWFnZU1vZGFsQ2FwdGlvbiA9XHJcbiAgICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNhcHRpb25cIik7XHJcblxyXG4gICAgLypJbiB0aGUgb3BlbigpIG1ldGhvZCBvZiB0aGUgUG9wdXBXaXRoSW1hZ2UgY2xhc3MsIFxyXG4gICAgeW91IG5lZWQgdG8gYWRkIGFuIGltYWdlIHRvIHRoZSBwb3B1cCBhbmQgdGhlIFxyXG4gICAgY29ycmVzcG9uZGluZyBpbWFnZSBzcmMgYXR0cmlidXRlIGFsb25nIHdpdGggYSBcclxuICAgIGNhcHRpb24gZm9yIHRoZSBpbWFnZS4qL1xyXG4gICAgaW1hZ2VNb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgaW1hZ2VNb2RhbENhcmQuc3JjID0gY2FyZERhdGEubGluaztcclxuICAgIGltYWdlTW9kYWxDYXJkLmFsdCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsIi8qZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiXHJcbiAgfVxyXG59KVxyXG4gIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgfSk7Ki9cclxuXHJcbiAgZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGxpbmspIHtcclxuICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgdGhpcy5saW5rID0gbGluaztcclxuICAgIH1cclxuICAgIGdldEFwcEluZm8oKSB7XHJcbiAgICAgIHJldHVybiBQcm9taXNlLmFsbChbdGhpcy5nZXRJbml0aWFsQ2FyZHMoKSwgdGhpcy5nZXRVc2VySW5mbygpXSlcclxuICAgIH1cclxuICAgIFxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsIHtcclxuICBtZXRob2Q6IFwiR2V0XCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCJcclxuICB9XHJcbn0pXHJcbiAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiBcclxuICAgIC8qLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgICAvLyBwcm9jZXNzIHRoZSByZXN1bHRcclxuICAgICAgcmV0dXJuIHJlc3VsdC5qc29uO1xyXG4gICAgfSkqL1xyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5lcnJvcihlcnIpOyAvLyBsb2cgdGhlIGVycm9yIHRvIHRoZSBjb25zb2xlXHJcbiAgfSk7XHJcbiAgICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiBcIk1hcmllIFNrxYJvZG93c2thIEN1cmllXCIsXHJcbiAgICAgICAgYWJvdXQ6IFwiUGh5c2ljaXN0IGFuZCBDaGVtaXN0XCJcclxuICAgICAgfSlcclxuICAgIH0pOyBcclxuICB9XHJcbiAgYWRkQ2FyZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXBJZC9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQb3N0XCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICB9XHJcbiAgZGVsZXRlQ2FyZCgpIHtcclxuICAgcmV0dXJuIGRlbGV0ZShcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHNcIiwge1xyXG4gICAgbWV0aG9kOiBcIkRlbGV0ZVwiLCAgXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIlxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgIC50aGVuKCgpID0+IGRlbGV0ZUNhcmQgKTtcclxuICAgICAgXHJcbiAgfVxyXG4gIGFkZENhcmRMaWtlKCkge1xyXG4gICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzL2xpa2VzL2NhcmRJZCBcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiUHV0XCIsICBcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIlxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgICAgICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuICAgICAgICBcclxuICB9XHJcbiAgcmVtb3ZlQ2FyZExpa2UoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvY2FyZElkXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkRlbGV0ZVwiLCAgXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCJcclxuICAgICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgfVxyXG4gICAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuICB9XHJcbiAgXHJcbiAgIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfY2FyZFNlbGVjdG9yIiwiX2NhcmRUZW1wbGF0ZUlucHV0IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiX2NhcmRFbGVtZW50IiwiY2xvbmVOb2RlIiwiX2hhbmRsZUNhcmRDbGljayIsIl9tb2RhbERlbGV0ZUJ1dHRvbiIsImxpa2VzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VJY29uIiwiX2RlbGV0ZUJ0biIsIl9oYW5kbGVEZWxldGVCdG4iLCJoYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbiIsInNldExpa2VzSW5mbyIsIl91cGRhdGVMaWtlc1ZpZXciLCJ0ZXh0Q29udGVudCIsImxlbmd0aCIsImNsYXNzTGlzdCIsInRvZ2dsZSIsImFkZCIsInJlbW92ZSIsIl9nZXRUZW1wbGF0ZSIsImdldENhcmQiLCJzcmMiLCJhbHQiLCJGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvbk9wdGlvbnMiLCJmb3JtRWxlbWVudCIsIl9mb3JtU2VsZWN0b3IiLCJfaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiX2Zvcm0iLCJfaW5wdXRMaXN0IiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsIl9zYXZlQnV0dG9uIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiX2Vycm9yTWVzc2FnZUVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc0ludmFsaWRJbnB1dCIsImV2ZXJ5IiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwic2F2ZUJ1dHRvbiIsIm9wdGlvbnMiLCJkaXNhYmxlZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJmb3JFYWNoIiwiZW5hYmxlVmFsaWRhdGlvbiIsImV2dCIsInByZXZlbnREZWZhdWx0IiwiU2VjdGlvbiIsImNvbnRhaW5lciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfY29udGFpbmVyIiwicmVuZGVySXRlbXMiLCJhZGRJdGVtIiwiaXRlbSIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50IiwibW9kYWxDbG9zZUJ1dHRvbiIsIm9wZW4iLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJ3aGljaCIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2siLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX21vZGFsRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsInZhbHVlIiwicmVzZXQiLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVTdWJoZWFkaW5nSW5wdXQiLCJjYXJkVGVtcGxhdGVJbnB1dCIsImFkZENhcmRFZGl0TW9kYWwiLCJhZGRDYXJkQnV0dG9uIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJzdWJoZWFkaW5nIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiZWRpdE1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwicmVuZGVyQ2FyZCIsImltYWdlTW9kYWwiLCJpbWFnZU1vZGFsQ2FyZCIsImNhcmQiLCJzZWN0aW9uIiwicHJvZmlsZURhdGEiLCJhcGkiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJ0aGVuIiwicmVzIiwianNvbiIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImVycm9yIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImFkZENhcmQiLCJkZWxldGVDYXJkIiwiYWRkQ2FyZExpa2UiLCJyZW1vdmVDYXJkTGlrZSIsImJhc2VVcmwiLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=