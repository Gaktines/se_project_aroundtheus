!function(){"use strict";class e{constructor(e){let{cardData:t,cardSelector:o,_handleCardClick:r,handleDeleteClick:s,processLikeClick:n,userId:a}=e;this._cardId=t._id,this._name=t.name,this._link=t.link,this._cardSelector=o,this._cardTemplateInput=document.querySelector("#card-template").content.firstElementChild,this._cardElement=this._cardTemplateInput.cloneNode(!0),this._handleCardClick=r,this._handleDeleteClick=s,this._userId=a,this._currentUserId=t.owner._id,this._processLikeClick=n,this._modalDeleteButton=document.querySelector("#modal-delete-btn"),this._likes=t.likes}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__button"),this._likeButton.addEventListener("click",(()=>{this._processLikeClick(this)})),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteClick(this._cardId)})),this._cardElement.querySelector("#card-image").addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link})))}setLikesInfo(e){this._likes=e,this._updateLikesView()}_updateLikesView(){this._cardElement.querySelector(".card__number").textContent=this._likes.length}_handleLikeIcon=()=>{this._likeButton.classList.toggle("card__button_active")};handleModalDeleteButton(){this._cardElement.remove()}handleDeleteButton(){this._deleteBtn=this._cardElement.querySelector("#card-delete-button"),console.log(this._userId),this._currentUserId!=this._userId&&this._deleteBtn.remove()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCard(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector("#card-image").src=this._link,this._cardElement.querySelector("#card-name").textContent=this._name,this._cardElement.querySelector("#card-image").alt=this._name,this.handleDeleteButton(),this._setEventListeners(),this._updateLikesView(),this._cardElement}}class t{constructor(e,t){this._formSelector=".modal__form",this._inputSelector=".modal__input",this._submitButtonSelector=".modal__button",this._inactiveButtonClass="modal__button_disabled",this._inputErrorClass="modal__input_type_error",this._errorClass="modal__error_visible",this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._saveButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(e,t){if(this._hasInvalidInput())return this._saveButton.classList.add(this._inactiveButtonClass),void(this._saveButton.disabled=!0);this._saveButton.classList.remove(this._inactiveButtonClass),this._saveButton.disabled=!1}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class o{constructor(e,t){let{items:o,renderer:r}=e;this.items=o,this.renderer=r,this._container=document.querySelector(t)}renderItems(){this.items.forEach(this.renderer)}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._modalElement=document.querySelector(t),this.modalCloseButton=this._modalElement.querySelector("#modal-close-button")}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{27===e.which&&this.close()};setEventListeners(){this._modalElement.addEventListener("click",this.closeModalOnRemoteClick)}closeModalOnRemoteClick=e=>{(e.target===e.currentTarget||e.target.classList.contains("modal__close"))&&this.close(e.target)}}class s extends r{constructor(e){let{popupSelector:t,handleFormSubmit:o}=e;super({popupSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=o}_getInputValues(){const e={};return this._modalForm.querySelectorAll(".modal__input").forEach((t=>{const o=t.name,r=t.value;e[o]=r})),e}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}open(){super.open()}close(){this._modalForm.reset(),super.close()}setSubmitAction(e){this._handleFormSubmit=e}}const n=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),i=(document.querySelector("#profile-modal-close-button"),document.querySelector("#profile-title"),document.querySelector("#profile-subheading"),document.querySelector("#profile-modal-title")),l=document.querySelector("#modal-subheading"),d=(a.querySelector("#profile-modal-form"),document.querySelector("#card-template").content.firstElementChild),c=document.querySelector("#add-card-edit-modal"),u=(document.querySelector("#add-card-modal-close-button"),document.querySelector("#profile-add-button")),m=(document.querySelector("#add-card-modal-title"),document.querySelector("#add-card-link"),c.querySelector("#add-card-modal-form"),document.querySelector("#card-list"),document.querySelector("#modal-close-button"),document.querySelector("#modal-delete")),h={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},_=document.querySelector(".profile__image_button"),p=document.querySelector("#modal-profile-image"),S=document.querySelector(".modal__button_save"),f=new t(h,a),b=new t(h,c);f.enableValidation(),b.enableValidation();const E=new class{constructor(e){let{name:t,subheading:o}=e;this.name=document.querySelector(t),this.subheading=document.querySelector(o)}getUserInfo(){return{name:this.name.textContent,subheading:this.subheading.textContent}}setUserInfo(e){let{name:t,subheading:o}=e;this.name.textContent=t,this.subheading.textContent=o}}({name:".profile__title",subheading:".profile__subheading"}),v=new s({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){E.setUserInfo(e),v.close()}});v.setEventListeners();const k=new s({popupSelector:"#add-card-edit-modal",handleFormSubmit:function(e){q.addCard(e).then((e=>{L(e),k.close()}))}});k.setEventListeners();const y=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t})}open(e){const t=this._modalElement.querySelector("#modal-image");this._modalElement.querySelector("#modal-caption").textContent=e.name,t.src=e.link,t.alt=e.name,super.open()}}({popupSelector:"#image-modal"});y.setEventListeners();const g=new s({popupSelector:"#modal-delete",handleFormSubmit:()=>{}});function C(e){this._likes>=0?q.removeCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)})):q.addCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)}))}function L(t){const o=new e({cardData:t,cardSelector:"#card-template",_handleCardClick:e=>{let{name:t,link:o}=e;y.open({name:t,link:o})},handleDeleteClick:e=>{m.classList.add("modal_opened"),g.setSubmitAction((()=>{q.deleteCard(e).then((e=>{o.handleModalDeleteButton(),m.classList.remove("modal_opened")}))}))},processLikeClick:C,userId:B});I.addItem(o.getCard())}g.setEventListeners(),_.addEventListener("click",(()=>{document.querySelector("#modal-profile-image").classList.add(".modal_opened")})),S.addEventListener("click",(()=>{!function(e){(void 0).preventDefault();const t=document.querySelector(".profile__image");t=document.querySelector("#profile-image-link").value}()})),d.cloneNode(!0).querySelector("#card-image"),n.addEventListener("click",(()=>{const e=E.getUserInfo();i.value=e.name,l.value=e.subheading,v.open()})),u.addEventListener("click",(()=>{b.toggleButtonState(),k.open()}));const q=new class{constructor(e,t){this.name=e,this.link=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch("https://around.nomoreparties.co/v1/group-12/cards",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json())).catch((e=>{console.error(e)}))}getUserInfo(){return fetch("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}}).then((e=>e.json()))}updateUserInfo(e,t){return fetch("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})}).then((e=>e.json()))}addCard(e){let{name:t,link:o}=e;return fetch("https://around.nomoreparties.co/v1/group-12/cards",{method:"POST",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:t,link:o})}).then((e=>e.json()))}deleteCard(e){return fetch(`https://around.nomoreparties.co/v1/group-12/cards/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json()))}handleDeleteButton(){this.deleteBtnModal=document.querySelector("#modal-delete"),this.deleteBtnModal.classList.add(".modal_opened")}handleCardLikes(){return Promise.all([this.addCardLike(),this.removeCardLike()])}addCardLike(e){return fetch(`https://around.nomoreparties.co/v1/group-12/cards/likes/${e}`,{method:"PUT",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json()))}removeCardLike(e){return fetch(`https://around.nomoreparties.co/v1/groupId/cards/likes/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}}).then((e=>e.json()))}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}});let I,B;q.getAppInfo().then((e=>{let[t,r]=e;B=r._id,I=new o({items:t,renderer:L},".cards__list"),I.renderItems()})),_.addEventListener("click",(()=>{p.classList.add("modal_opened")}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFVLElBQUkzRSxFQUFRLENBQUVFLE1BQU9nRyxFQUFPL0YsU0FBVTZELEdBQWMsZ0JBQzlEVyxFQUFRdEUsYUFBYSxJQVdyQjRDLEVBQW1CdEcsaUJBQWlCLFNBQVMsS0FDM0N1RyxFQUFrQmhHLFVBQVU4QixJQUFJLGVBQWUsRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FQSS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xyXG4gIGNvbnN0cnVjdG9yKHtcclxuICAgIGNhcmREYXRhLFxyXG4gICAgY2FyZFNlbGVjdG9yLFxyXG4gICAgX2hhbmRsZUNhcmRDbGljayxcclxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxyXG4gICAgcHJvY2Vzc0xpa2VDbGljayxcclxuICAgIHVzZXJJZFxyXG4gICAgXHJcbiAgfSkge1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0LmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IF9oYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgLy90aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9jdXJyZW50VXNlcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fcHJvY2Vzc0xpa2VDbGljayA9IHByb2Nlc3NMaWtlQ2xpY2s7XHJcbiAgIFxyXG4gICAgdGhpcy5fbW9kYWxEZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWRlbGV0ZS1idG5cIik7XHJcbiAgICB0aGlzLl9saWtlcyA9IGNhcmREYXRhLmxpa2VzO1xyXG4gICAgXHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAvL1wiLmNhcmRfX2J1dHRvblwiXHJcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19idXR0b25cIik7XHJcbiAgICB0aGlzLl9saWtlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX3Byb2Nlc3NMaWtlQ2xpY2sodGhpcyk7XHJcbiAgICAgIFxyXG4gICAgfSk7XHJcbiAgICAvL1wiI2NhcmQtZGVsZXRlLWJ1dHRvblwiXHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2NhcmRJZCk7XHJcbiAgICB9KTtcclxuICAgIC8vaW1hZ2VcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICAgKTtcclxuICAgIC8vXCIjbW9kYWwtZGVsZXRlLWJ0blwiXHJcbiAgfVxyXG4gIHNldExpa2VzSW5mbyhsaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VzVmlldygpO1xyXG4gIH1cclxuICBfdXBkYXRlTGlrZXNWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19udW1iZXJcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgLy8gIHRoYXQgZWRpdHMgdGhlIC50ZXh0Q29udGVudCBvZiB0aGUgc3BhbiB3aXRoIHRoZSBudW1iZXJcclxuICAgIC8vaW4gaXQgdG8gbWF0Y2ggaG93IG1hbnkgdGhpcy5fbGlrZXMgdGhlcmUgYXJlLFxyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUxpa2VJY29uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnV0dG9uX2FjdGl2ZVwiKTtcclxuXHJcbiAgfTtcclxuICAvKl9oYW5kbGVEZWxldGVCdG4oKSB7XHJcbiAgICBjb25zdCBkZWxldGVCdG5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG4gICAgZGVsZXRlQnRuTW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICB9Ki9cclxuICBoYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbigpIHtcclxuICAgICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2RlbGV0ZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fdXNlcklkKTtcclxuICAgIGlmICh0aGlzLl9jdXJyZW50VXNlcklkICE9IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdG4ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIikuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1uYW1lXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuaGFuZGxlRGVsZXRlQnV0dG9uKCk7XHJcbiAgICAvL3NldCB0aGUgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZXNWaWV3KCk7XHJcblxyXG4gICAgLy9yZXR1cm4gdGhlIGNhcmRcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuLy9fdXBkYXRlTGlrZXNWaWV3IGlzIGNhbGxlZCBpbiBnZXRWaWV3ICh3aGljaCByZXR1cm5zIHRoZSBjYXJkXHJcbi8vSFRNTCBpbml0aWFsbHkpLCBhbmQgaW4gc2V0TGlrZXNJbmZvIHdoaWNoIHVwZGF0ZXMgdGhlXHJcbi8vdGhpcy5fbGlrZXMgYXJyYXkgYmFzZWQgb24gdGhlIGFyZ3VtZW50cyBwYXNzZWQgaW50byBpdFxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uT3B0aW9ucywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IFwiLm1vZGFsX19mb3JtXCI7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gXCIubW9kYWxfX2lucHV0XCI7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IFwiLm1vZGFsX19idXR0b25cIjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIjtcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCI7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gIXRoaXMuX2lucHV0TGlzdC5ldmVyeShcclxuICAgICAgKGlucHV0RWxlbWVudCkgPT4gaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkXHJcbiAgICApO1xyXG4gIH1cclxuICB0b2dnbGVCdXR0b25TdGF0ZShzYXZlQnV0dG9uLCBvcHRpb25zKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9zYXZlQnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc2F2ZUJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xyXG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIFxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lcikge1xyXG4gICAgdGhpcy5pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLml0ZW1zLmZvckVhY2godGhpcy5yZW5kZXJlcik7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGl0ZW0pIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGl0ZW0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XHJcbiAgICB0aGlzLm1vZGFsQ2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgXCIjbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuICAgICk7XHJcbiAgfVxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgY29uc3QgRVNDX0tFWUNPREUgPSAyNztcclxuICAgIGlmIChldnQud2hpY2ggPT09IEVTQ19LRVlDT0RFKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH1cclxuICB9O1xyXG4gXHJcblxyXG4gIFxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLmNsb3NlTW9kYWxPblJlbW90ZUNsaWNrKTtcclxuICB9XHJcbiAgY2xvc2VNb2RhbE9uUmVtb3RlQ2xpY2sgPSAoZXZ0KSA9PiB7XHJcbiAgICBpZiAoXHJcbiAgICAgIGV2dC50YXJnZXQgPT09IGV2dC5jdXJyZW50VGFyZ2V0IHx8XHJcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXHJcbiAgICApIHtcclxuICAgICAgdGhpcy5jbG9zZShldnQudGFyZ2V0KTtcclxuICAgIH1cclxuICB9O1xyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcclxuICB9XHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIGNvbnN0IGlucHV0cyA9IHRoaXMuX21vZGFsRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcclxuICAgIGlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICBjb25zdCBuYW1lID0gaW5wdXQubmFtZTtcclxuICAgICAgY29uc3QgdmFsdWUgPSBpbnB1dC52YWx1ZTtcclxuICAgICAgaW5wdXRWYWx1ZXNbbmFtZV0gPSB2YWx1ZTtcclxuICAgIH0pO1xyXG4gICAgcmV0dXJuIGlucHV0VmFsdWVzO1xyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vc3VibWl0IGV2ZW50XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpOyBcclxuICB9XHJcblxyXG4gIHNldFN1Ym1pdEFjdGlvbihhY3Rpb24pIHtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBhY3Rpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQgXCIuLi9wYWdlcy9pbmRleC5jc3NcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQVBJLmpzXCI7XHJcblxyXG4vKmNvbnN0IGNhcmREYXRhID0ge1xyXG4gIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcclxuICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGcgXCIsXHJcbn07Ki9cclxuXHJcbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBwcm9maWxlRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IHByb2ZpbGVNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNwcm9maWxlLW1vZGFsLWNsb3NlLWJ1dHRvblwiXHJcbik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZVwiKTtcclxuY29uc3QgcHJvZmlsZVN1YmhlYWRpbmcgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtc3ViaGVhZGluZ1wiKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbW9kYWwtdGl0bGVcIik7XHJcbmNvbnN0IHByb2ZpbGVTdWJoZWFkaW5nSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLXN1YmhlYWRpbmdcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZUlucHV0ID1cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcbmNvbnN0IGFkZENhcmRFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNhZGQtY2FyZC1tb2RhbC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbC10aXRsZVwiKTtcclxuY29uc3QgYWRkQ2FyZExpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGlua1wiKTtcclxuXHJcbmNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZEVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGNhcmRzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1saXN0XCIpO1xyXG5cclxuY29uc3QgaW1hZ2VNb2RhbENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1jbG9zZS1idXR0b25cIik7XHJcbmNvbnN0IGRlbGV0ZUJ0bk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGVcIik7XHJcbmNvbnN0IHZhbGlkYXRpb25PcHRpb25zID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuY29uc3QgcHJvZmlsZUltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZV9idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1wcm9maWxlLWltYWdlXCIpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2VTYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uX3NhdmVcIik7XHJcblxyXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gIHByb2ZpbGVFZGl0TW9kYWxcclxuKTtcclxuY29uc3QgYWRkQ2FyZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICB2YWxpZGF0aW9uT3B0aW9ucyxcclxuICBhZGRDYXJkRWRpdE1vZGFsXHJcbik7XHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkQ2FyZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX3RpdGxlXCIsXHJcbiAgc3ViaGVhZGluZzogXCIucHJvZmlsZV9fc3ViaGVhZGluZ1wiLFxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiBoYW5kbGVFZGl0TW9kYWxGb3JtU3VibWl0LFxyXG59KTtcclxuZWRpdE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGFkZENhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtY2FyZC1lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQsXHJcbn0pO1xyXG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgaW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjaW1hZ2UtbW9kYWxcIixcclxufSk7XHJcbmltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuY29uc3QgY2FyZERlbGV0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI21vZGFsLWRlbGV0ZVwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6ICgpID0+IHt9LFxyXG59KTtcclxuY2FyZERlbGV0ZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG5wcm9maWxlSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBwcm9maWxlSW1hZ2VNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtcHJvZmlsZS1pbWFnZVwiKTtcclxuICBwcm9maWxlSW1hZ2VNb2RhbC5jbGFzc0xpc3QuYWRkKFwiLm1vZGFsX29wZW5lZFwiKTtcclxufSk7XHJcblxyXG5wcm9maWxlSW1hZ2VTYXZlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgaGFuZGxlUHJvZmlsZUltYWdlRm9ybSgpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIHByb2Nlc3NMaWtlQ2xpY2soY2FyZCkge1xyXG4gIGlmICh0aGlzLl9saWtlcyA+PSAwKXtcclxuICAgIGFwaS5yZW1vdmVDYXJkTGlrZShjYXJkLl9jYXJkSWQpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIGNhcmQuc2V0TGlrZXNJbmZvKGRhdGEubGlrZXMpO1xyXG4gIH0pO30gZWxzZSB7XHJcbiAgICBhcGkuYWRkQ2FyZExpa2UoY2FyZC5fY2FyZElkKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmQuc2V0TGlrZXNJbmZvKGRhdGEubGlrZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIFxyXG4gIFxyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgY2FyZERhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3I6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIF9oYW5kbGVDYXJkQ2xpY2s6ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xyXG4gICAgICAvL2hlcmUgaXMgd2hlcmUgd2Ugd2FudCB0byBvcGVuIG91ciBwb3B1cFdpdGhJbWFnZSBpbnN0YW5jZS5cclxuICAgICAgaW1hZ2VNb2RhbC5vcGVuKHsgbmFtZSwgbGluayB9KTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDbGljazogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAvLyBvcGVuIHRoZSBtb2RhbFxyXG4gICAgICBvcGVuRGVsZXRlTW9kYWwoKTtcclxuICAgICAgLy8gc2V0IGEgc3VibWl0IGFjdGlvblxyXG4gICAgICBjYXJkRGVsZXRlTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBhcGkuZGVsZXRlQ2FyZChjYXJkSWQpLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgICAgY2FyZC5oYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbigpO1xyXG4gICAgICAgICAgY2xvc2VEZWxldGVNb2RhbCgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcbiAgICBwcm9jZXNzTGlrZUNsaWNrLFxyXG5cclxuICAgIHVzZXJJZCxcclxuICB9KTtcclxuXHJcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmQuZ2V0Q2FyZCgpKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVFZGl0TW9kYWxGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XHJcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMpO1xyXG4gIGVkaXRNb2RhbC5jbG9zZSgpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGNhcmREYXRhKSB7XHJcbiAgYXBpLmFkZENhcmQoY2FyZERhdGEpLnRoZW4oKGNhcmREYXRhKSA9PiB7XHJcbiAgICByZW5kZXJDYXJkKGNhcmREYXRhKTtcclxuICAgIGFkZENhcmRNb2RhbC5jbG9zZSgpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdEZvcm0oZXZ0KSB7XHJcbiAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgcHJvZmlsZVRpdGxlLnRleHRDb250ZW50ID0gcHJvZmlsZVRpdGxlSW5wdXQudmFsdWU7XHJcbiAgcHJvZmlsZVN1YmhlYWRpbmcudGV4dENvbnRlbnQgPSBwcm9maWxlU3ViaGVhZGluZ0lucHV0LnZhbHVlO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlSW1hZ2VGb3JtKGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW1hZ2VcIik7XHJcbiAgY29uc3QgcHJvZmlsZUltYWdlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtaW1hZ2UtbGlua1wiKTtcclxuICBwcm9maWxlSW1hZ2UgPSBwcm9maWxlSW1hZ2VJbnB1dC52YWx1ZTtcclxufVxyXG5cclxuY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGVJbnB1dC5jbG9uZU5vZGUodHJ1ZSk7XHJcblxyXG5jb25zdCBjYXJkSW1hZ2VFbGVtZW50ID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWltYWdlXCIpO1xyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVTdWJoZWFkaW5nSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5zdWJoZWFkaW5nO1xyXG4gIGVkaXRNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGFkZENhcmRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTJcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbmxldCBzZWN0aW9uO1xyXG5sZXQgdXNlcklkO1xyXG5cclxuYXBpLmdldEFwcEluZm8oKS50aGVuKChbY2FyZHMsIHVzZXJJbmZvXSkgPT4ge1xyXG4gIHVzZXJJZCA9IHVzZXJJbmZvLl9pZDtcclxuICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oeyBpdGVtczogY2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sIFwiLmNhcmRzX19saXN0XCIpO1xyXG4gIHNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxufSk7XHJcblxyXG4vL2FwaS51cGRhdGVVc2VySW5mbygpO1xyXG5vcGVuUHJvZmlsZUltYWdlTW9kYWwoKTtcclxuXHJcbi8qZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZElkKSB7XHJcblxyXG59Ki9cclxuXHJcbmZ1bmN0aW9uIG9wZW5Qcm9maWxlSW1hZ2VNb2RhbCgpIHtcclxuICBwcm9maWxlSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIHByb2ZpbGVJbWFnZU1vZGFsLmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIG9wZW5EZWxldGVNb2RhbCgpIHtcclxuICBkZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjbG9zZURlbGV0ZU1vZGFsKCkge1xyXG4gIGRlbGV0ZUJ0bk1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgc3ViaGVhZGluZyB9KSB7XHJcbiAgICB0aGlzLm5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5zdWJoZWFkaW5nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzdWJoZWFkaW5nKTtcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAvLyByZXR1cm4gdGhlIHRleHQgcHJvcGVydGllcyBvZiB0aGlzLm5hbWUgYW5kIHRoaXMuam9iXHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLm5hbWUudGV4dENvbnRlbnQsIHN1YmhlYWRpbmc6IHRoaXMuc3ViaGVhZGluZy50ZXh0Q29udGVudCB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIHN1YmhlYWRpbmcgfSkge1xyXG4gICAgLy8gV2hlbiBmb3JtIGlzIHN1Ym1pdHRlZCwgc2V0IHRoZSBwcm9maWxlIGluZm9cclxuICAgIHRoaXMubmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLnN1YmhlYWRpbmcudGV4dENvbnRlbnQgPSBzdWJoZWFkaW5nO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICB9XHJcbiAgb3BlbihjYXJkRGF0YSkge1xyXG4gICAgY29uc3QgaW1hZ2VNb2RhbENhcmQgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1pbWFnZVwiKTtcclxuICAgIGNvbnN0IGltYWdlTW9kYWxDYXB0aW9uID1cclxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtY2FwdGlvblwiKTtcclxuXHJcbiAgICAvKkluIHRoZSBvcGVuKCkgbWV0aG9kIG9mIHRoZSBQb3B1cFdpdGhJbWFnZSBjbGFzcywgXHJcbiAgICB5b3UgbmVlZCB0byBhZGQgYW4gaW1hZ2UgdG8gdGhlIHBvcHVwIGFuZCB0aGUgXHJcbiAgICBjb3JyZXNwb25kaW5nIGltYWdlIHNyYyBhdHRyaWJ1dGUgYWxvbmcgd2l0aCBhIFxyXG4gICAgY2FwdGlvbiBmb3IgdGhlIGltYWdlLiovXHJcbiAgICBpbWFnZU1vZGFsQ2FwdGlvbi50ZXh0Q29udGVudCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBpbWFnZU1vZGFsQ2FyZC5zcmMgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgaW1hZ2VNb2RhbENhcmQuYWx0ID0gY2FyZERhdGEubmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIiwiLypmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIiwge1xyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCJcclxuICB9XHJcbn0pXHJcbiAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgLnRoZW4oKHJlc3VsdCkgPT4ge1xyXG4gICAgY29uc29sZS5sb2cocmVzdWx0KTtcclxuICB9KTsqL1xyXG5cclxuICBleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IobmFtZSwgbGluaykge1xyXG4gICAgICB0aGlzLm5hbWUgPSBuYW1lO1xyXG4gICAgICB0aGlzLmxpbmsgPSBsaW5rO1xyXG4gICAgfVxyXG4gICAgZ2V0QXBwSW5mbygpIHtcclxuICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmdldEluaXRpYWxDYXJkcygpLCB0aGlzLmdldFVzZXJJbmZvKCldKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHNcIiwge1xyXG4gIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIlxyXG4gIH1cclxufSlcclxuICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSlcclxuIFxyXG4gICAgLyoudGhlbigocmVzdWx0KSA9PiB7XHJcbiAgICAgIC8vIHByb2Nlc3MgdGhlIHJlc3VsdFxyXG4gICAgICByZXR1cm4gcmVzdWx0Lmpzb247XHJcbiAgICB9KSovXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7IC8vIGxvZyB0aGUgZXJyb3IgdG8gdGhlIGNvbnNvbGVcclxuICB9KTtcclxuICAgIH1cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIiwge1xyXG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICB9KS50aGVuKHJlcyA9PiByZXMuanNvbigpKTsgXHJcbiAgfVxyXG4gIHVwZGF0ZVVzZXJJbmZvKG5hbWUsIGFib3V0KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgIG5hbWUsXHJcbiAgICAgIGFib3V0XHJcbiAgICAgIH0pXHJcbiAgICB9KS50aGVuKHJlcyA9PiByZXMuanNvbigpKTsgXHJcbiAgfVxyXG4gIFxyXG4gIGFkZENhcmQoe25hbWUsIGxpbmt9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcclxuICAgICAgfSxcclxuICAgICAgYm9keTpKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rXHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpXHJcbiAgfVxyXG4gIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgcmV0dXJuIGZldGNoKGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzLyR7aWR9YCwge1xyXG4gICAgbWV0aG9kOiBcIkRFTEVURVwiLCAgXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIlxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgICBcclxuICB9XHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICB9XHJcbiAgaGFuZGxlQ2FyZExpa2VzKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmFkZENhcmRMaWtlKCksIHRoaXMucmVtb3ZlQ2FyZExpa2UoKV0pXHJcbiAgfVxyXG4gIGFkZENhcmRMaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICBtZXRob2Q6IFwiUFVUXCIsICBcclxuICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiXHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gICAgICAgIFxyXG4gIH1cclxuICByZW1vdmVDYXJkTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwSWQvY2FyZHMvbGlrZXMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIiwgIFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gIH1cclxuICAgIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcbiAgIC8qIGhhbmRsZUxpa2VDbGljaygpICB7XHJcbiAgICAgIC8vdGVsbCBBUEkgdG8gYWRkIGxpa2VcclxuICAgICAgcmV0dXJuIGZldGNoKGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgbWV0aG9kOiBcIlBVVFwiLCAgXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIlxyXG4gICAgICB9XHJcbiAgICB9KVxyXG4gICAgLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpO1xyXG4gICAgICAvL2dldCByZXNwb25zZSBmcm9tIEFQSVxyXG4gICAgXHJcbiAgfSovXHJcbiAgXHJcbiAgXHJcbn1cclxuICAiXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmREYXRhIiwiY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwicHJvY2Vzc0xpa2VDbGljayIsInVzZXJJZCIsInRoaXMiLCJfY2FyZElkIiwiX2lkIiwiX25hbWUiLCJuYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2NhcmRTZWxlY3RvciIsIl9jYXJkVGVtcGxhdGVJbnB1dCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsImNvbnRlbnQiLCJmaXJzdEVsZW1lbnRDaGlsZCIsIl9jYXJkRWxlbWVudCIsImNsb25lTm9kZSIsIl9oYW5kbGVEZWxldGVDbGljayIsIl91c2VySWQiLCJfY3VycmVudFVzZXJJZCIsIm93bmVyIiwiX3Byb2Nlc3NMaWtlQ2xpY2siLCJfbW9kYWxEZWxldGVCdXR0b24iLCJfbGlrZXMiLCJsaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdG4iLCJzZXRMaWtlc0luZm8iLCJfdXBkYXRlTGlrZXNWaWV3IiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJfaGFuZGxlTGlrZUljb24iLCJjbGFzc0xpc3QiLCJ0b2dnbGUiLCJoYW5kbGVNb2RhbERlbGV0ZUJ1dHRvbiIsInJlbW92ZSIsImhhbmRsZURlbGV0ZUJ1dHRvbiIsImNvbnNvbGUiLCJsb2ciLCJfZ2V0VGVtcGxhdGUiLCJnZXRDYXJkIiwic3JjIiwiYWx0IiwiRm9ybVZhbGlkYXRvciIsInZhbGlkYXRpb25PcHRpb25zIiwiZm9ybUVsZW1lbnQiLCJfZm9ybVNlbGVjdG9yIiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsIl9mb3JtIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2F2ZUJ1dHRvbiIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsIl9lcnJvck1lc3NhZ2VFbGVtZW50IiwiaWQiLCJhZGQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsInZhbGlkaXR5IiwidmFsaWQiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsInNhdmVCdXR0b24iLCJvcHRpb25zIiwiZGlzYWJsZWQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwiZm9yRWFjaCIsImVuYWJsZVZhbGlkYXRpb24iLCJldnQiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJjb250YWluZXIiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiYWRkSXRlbSIsIml0ZW0iLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsIm1vZGFsQ2xvc2VCdXR0b24iLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwid2hpY2giLCJzZXRFdmVudExpc3RlbmVycyIsImNsb3NlTW9kYWxPblJlbW90ZUNsaWNrIiwidGFyZ2V0IiwiY3VycmVudFRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9tb2RhbEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0Iiwic2V0U3VibWl0QWN0aW9uIiwiYWN0aW9uIiwicHJvZmlsZUVkaXRCdXR0b24iLCJwcm9maWxlRWRpdE1vZGFsIiwicHJvZmlsZVRpdGxlSW5wdXQiLCJwcm9maWxlU3ViaGVhZGluZ0lucHV0IiwiY2FyZFRlbXBsYXRlSW5wdXQiLCJhZGRDYXJkRWRpdE1vZGFsIiwiYWRkQ2FyZEJ1dHRvbiIsImRlbGV0ZUJ0bk1vZGFsIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwcm9maWxlSW1hZ2VCdXR0b24iLCJwcm9maWxlSW1hZ2VNb2RhbCIsInByb2ZpbGVJbWFnZVNhdmVCdXR0b24iLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZENhcmRGb3JtVmFsaWRhdG9yIiwidXNlckluZm8iLCJzdWJoZWFkaW5nIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsIl9yZWYyIiwiZWRpdE1vZGFsIiwiYWRkQ2FyZE1vZGFsIiwiYXBpIiwiYWRkQ2FyZCIsInRoZW4iLCJyZW5kZXJDYXJkIiwiaW1hZ2VNb2RhbCIsImltYWdlTW9kYWxDYXJkIiwiY2FyZERlbGV0ZU1vZGFsIiwiY2FyZCIsInJlbW92ZUNhcmRMaWtlIiwiZGF0YSIsImFkZENhcmRMaWtlIiwiY2FyZElkIiwiZGVsZXRlQ2FyZCIsInJlcyIsInNlY3Rpb24iLCJoYW5kbGVQcm9maWxlSW1hZ2VGb3JtIiwicHJvZmlsZUltYWdlIiwicHJvZmlsZURhdGEiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJqc29uIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsInVwZGF0ZVVzZXJJbmZvIiwiYWJvdXQiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImhhbmRsZUNhcmRMaWtlcyIsImJhc2VVcmwiLCJjYXJkcyJdLCJzb3VyY2VSb290IjoiIn0=