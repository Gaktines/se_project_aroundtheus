!function(){"use strict";class e{constructor(e){let{cardData:t,cardSelector:o,_handleCardClick:r,handleDeleteClick:s,processLikeClick:n,userId:a}=e;this._cardId=t._id,this._name=t.name,this._link=t.link,this._cardSelector=o,this._cardTemplateInput=document.querySelector("#card-template").content.firstElementChild,this._cardElement=this._cardTemplateInput.cloneNode(!0),this._handleCardClick=r,this._handleDeleteClick=s,this._userId=a,this._currentUserId=t.owner._id,this._processLikeClick=n,this._modalDeleteButton=document.querySelector("#modal-delete-btn"),this._likes=t.likes}_setEventListeners(){this._likeButton=this._cardElement.querySelector(".card__button"),this._likeButton.addEventListener("click",(()=>{this._processLikeClick(this)})),this._deleteBtn.addEventListener("click",(()=>{this._handleDeleteClick(this._cardId)})),this._cardElement.querySelector("#card-image").addEventListener("click",(()=>this._handleCardClick({name:this._name,link:this._link})))}setLikesInfo(e){this._likes=e,this._updateLikesView()}_updateLikesView(){this._cardElement.querySelector(".card__number").textContent=this._likes.length}isLiked(){return this._likes.some((()=>this._currenUserId===this._likes._id))}handleModalDeleteButton(){this._cardElement.remove()}handleDeleteButton(){this._deleteBtn=this._cardElement.querySelector("#card-delete-button"),console.log(this._userId),this._currentUserId!=this._userId&&this._deleteBtn.remove()}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}getCard(){return this._cardElement=this._getTemplate(),this._cardElement.querySelector("#card-image").src=this._link,this._cardElement.querySelector("#card-name").textContent=this._name,this._cardElement.querySelector("#card-image").alt=this._name,this.handleDeleteButton(),this._setEventListeners(),this._updateLikesView(),this._cardElement}}class t{constructor(e,t){this._formSelector=".modal__form",this._inputSelector=".modal__input",this._submitButtonSelector=".modal__button",this._inactiveButtonClass="modal__button_disabled",this._inputErrorClass="modal__input_type_error",this._errorClass="modal__error_visible",this._form=t,this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._saveButton=this._form.querySelector(this._submitButtonSelector)}_showInputError(e){this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.add(this._inputErrorClass),this._errorMessageElement.textContent=e.validationMessage,this._errorMessageElement.classList.add(this._errorClass)}_hideInputError(e){console.log(`#${e.id}-error`),this._errorMessageElement=this._form.querySelector(`#${e.id}-error`),e.classList.remove(this._inputErrorClass),this._errorMessageElement.textContent="",this._errorMessageElement.classList.remove(this._errorClass)}_hasInvalidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(e,t){if(this._hasInvalidInput())return this._saveButton.classList.add(this._inactiveButtonClass),void(this._saveButton.disabled=!0);this._saveButton.classList.remove(this._inactiveButtonClass),this._saveButton.disabled=!1}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class o{constructor(e,t){let{items:o,renderer:r}=e;this.items=o,this.renderer=r,this._container=document.querySelector(t)}renderItems(){this.items.forEach(this.renderer)}addItem(e){this._container.prepend(e)}}class r{constructor(e){let{popupSelector:t}=e;this._modalElement=document.querySelector(t),this.modalCloseButton=this._modalElement.querySelector("#modal-close-button")}open(){this._modalElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{27===e.which&&this.close()};setEventListeners(){this._modalElement.addEventListener("click",this.closeModalOnRemoteClick)}closeModalOnRemoteClick=e=>{(e.target===e.currentTarget||e.target.classList.contains("modal__close"))&&this.close(e.target)}}class s extends r{constructor(e){let{popupSelector:t,handleFormSubmit:o}=e;super({popupSelector:t}),this._modalForm=this._modalElement.querySelector(".modal__form"),this._handleFormSubmit=o}_getInputValues(){const e={};return this._modalForm.querySelectorAll(".modal__input").forEach((t=>{const o=t.name,r=t.value;e[o]=r})),e}setLoading(e){const t=this._modalElement.querySelector(".modal__button");t.textContent=e?"Saving":t.textContent}setEventListeners(){super.setEventListeners(),this._modalForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}open(){super.open()}close(){this._modalForm.reset(),super.close()}setSubmitAction(e){this._handleFormSubmit=e}}const n=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),i=(document.querySelector("#profile-modal-close-button"),document.querySelector("#profile-title"),document.querySelector("#profile-about"),document.querySelector("#profile-modal-title")),l=document.querySelector("#modal-about"),d=(a.querySelector("#profile-modal-form"),document.querySelector("#card-template").content.firstElementChild,document.querySelector("#add-card-edit-modal")),c=(document.querySelector("#add-card-modal-close-button"),document.querySelector("#profile-add-button")),u=(document.querySelector("#add-card-modal-title"),document.querySelector("#add-card-link"),d.querySelector("#add-card-modal-form"),document.querySelector("#card-list"),document.querySelector("#modal-close-button"),document.querySelector("#modal-delete")),m={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},h=document.querySelector(".profile__image-button"),_=document.querySelector(".modal__button_save"),p=document.querySelector("#modal-profile-image"),S=new t(m,a),b=new t(m,d);S.enableValidation(),b.enableValidation();const f=new class{constructor(e){let{name:t,about:o}=e;this.name=document.querySelector(t),this.about=document.querySelector(o)}getUserInfo(){return{name:this.name.textContent,about:this.about.textContent}}setUserInfo(e){let{name:t,about:o}=e;this.name.textContent=t,this.about.textContent=o}}({name:".profile__title",about:".profile__about"}),E=new s({popupSelector:"#profile-edit-modal",handleFormSubmit:function(e){E.setLoading(!0),I.updateUserInfo(e.name,e.about).then((e=>{f.setUserInfo(e),E.close()})),E.setLoading(!1)}});E.setEventListeners();const v=new s({popupSelector:"#add-card-edit-modal",handleFormSubmit:function(e){v.setLoading(!0),I.addCard(e).then((e=>{v.setLoading(!1),C(e),v.close()})).catch((e=>{console.error(e)}))}});v.setEventListeners();const k=new class extends r{constructor(e){let{popupSelector:t}=e;super({popupSelector:t})}open(e){const t=this._modalElement.querySelector("#modal-image");this._modalElement.querySelector("#modal-caption").textContent=e.name,t.src=e.link,t.alt=e.name,super.open()}}({popupSelector:"#image-modal"});k.setEventListeners();const g=new s({popupSelector:"#modal-delete",handleFormSubmit:()=>{}});g.setEventListeners();const L=new s({popupSelector:"#modal-profile-image",handleFormSubmit:q});function y(e){const t=e.isLiked();console.log(t),this._likeButton.classList.toggle("card__button_active"),t?I.removeCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)})):I.addCardLike(e._cardId).then((t=>{e.setLikesInfo(t.likes)}))}function C(t){const o=new e({cardData:t,cardSelector:"#card-template",_handleCardClick:e=>{let{name:t,link:o}=e;k.open({name:t,link:o})},handleDeleteClick:e=>{u.classList.add("modal_opened"),g.setSubmitAction((()=>{I.deleteCard(e).then((e=>{g.setLoading(!0),o.handleModalDeleteButton(),g.setLoading(!1),u.classList.remove("modal_opened")})).catch((e=>{console.error(e)}))}))},processLikeClick:y,userId:w});B.addItem(o.getCard())}function q(){L.setLoading(!0);const e=document.querySelector(".profile__image"),t=document.querySelector("#profile-image-link");e.src=t.value,L.setLoading(!1),I.updateProfileImage(),L.close()}L.setEventListeners(),new t(m,p).enableValidation(),h.addEventListener("click",(()=>{L.open()})),_.addEventListener("click",(()=>{q()})),n.addEventListener("click",(()=>{const e=f.getUserInfo();i.value=e.name,l.value=e.about,E.open()})),c.addEventListener("click",(()=>{b.toggleButtonState(),v.open()}));const I=new class{constructor(e,t){this.name=e,this.link=t}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return this._request("https://around.nomoreparties.co/v1/group-12/cards",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}updateProfileImage(){return this._request("https://around.nomoreparties.co/v1/group-12/users/me",{method:"PATCH",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({avatar:".profile__image"})})}getUserInfo(){return this._request("https://around.nomoreparties.co/v1/group-12/users/me",{method:"GET",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}})}updateUserInfo(e,t){return this._request("https://around.nomoreparties.co/v1/group-12/users/me",{method:"PATCH",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:e,about:t})})}addCard(e){let{name:t,link:o}=e;return this._request("https://around.nomoreparties.co/v1/group-12/cards",{method:"POST",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"},body:JSON.stringify({name:t,link:o})})}deleteCard(e){return this._request(`https://around.nomoreparties.co/v1/group-12/cards/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}handleDeleteButton(){this.deleteBtnModal=document.querySelector("#modal-delete"),this.deleteBtnModal.classList.add(".modal_opened")}handleCardLikes(){return Promise.all([this.addCardLike(),this.removeCardLike()])}addCardLike(e){return this._request(`https://around.nomoreparties.co/v1/group-12/cards/likes/${e}`,{method:"PUT",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}removeCardLike(e){return this._request(`https://around.nomoreparties.co/v1/group-12/cards/likes/${e}`,{method:"DELETE",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5"}})}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error ${JSON.stringify(e)}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}}({baseUrl:"https://around.nomoreparties.co/v1/group-12",headers:{authorization:"bb2f5d86-90ca-441b-9ac8-a1ee02058df5","Content-Type":"application/json"}});let B,w;I.getAppInfo().then((e=>{let[t,r]=e;w=r._id,B=new o({items:t,renderer:C},".cards__list"),B.renderItems(),f.setUserInfo({name:r.name,about:r.about})})).catch((e=>{console.error(e)})),h.addEventListener("click",(()=>{L.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QixTQUFTLEtBQzNDaUksRUFBa0I5RCxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BUEkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7XHJcbiAgICBjYXJkRGF0YSxcclxuICAgIGNhcmRTZWxlY3RvcixcclxuICAgIF9oYW5kbGVDYXJkQ2xpY2ssXHJcbiAgICBoYW5kbGVEZWxldGVDbGljayxcclxuICAgIHByb2Nlc3NMaWtlQ2xpY2ssXHJcbiAgICB1c2VySWQsXHJcbiAgfSkge1xyXG4gICAgdGhpcy5fY2FyZElkID0gY2FyZERhdGEuX2lkO1xyXG4gICAgdGhpcy5fbmFtZSA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9saW5rID0gY2FyZERhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0ID1cclxuICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2NhcmRUZW1wbGF0ZUlucHV0LmNsb25lTm9kZSh0cnVlKTtcclxuICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IF9oYW5kbGVDYXJkQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xyXG4gICAgLy90aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XHJcbiAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICB0aGlzLl9jdXJyZW50VXNlcklkID0gY2FyZERhdGEub3duZXIuX2lkO1xyXG4gICAgdGhpcy5fcHJvY2Vzc0xpa2VDbGljayA9IHByb2Nlc3NMaWtlQ2xpY2s7XHJcblxyXG4gICAgdGhpcy5fbW9kYWxEZWxldGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWRlbGV0ZS1idG5cIik7XHJcbiAgICB0aGlzLl9saWtlcyA9IGNhcmREYXRhLmxpa2VzO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgLy9cIi5jYXJkX19idXR0b25cIlxyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9wcm9jZXNzTGlrZUNsaWNrKHRoaXMpO1xyXG4gICAgfSk7XHJcbiAgICAvL1wiI2NhcmQtZGVsZXRlLWJ1dHRvblwiXHJcblxyXG4gICAgdGhpcy5fZGVsZXRlQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMuX2NhcmRJZCk7XHJcbiAgICB9KTtcclxuICAgIC8vaW1hZ2VcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIilcclxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PlxyXG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmsgfSlcclxuICAgICAgKTtcclxuICAgIC8vXCIjbW9kYWwtZGVsZXRlLWJ0blwiXHJcbiAgfVxyXG4gIHNldExpa2VzSW5mbyhsaWtlcykge1xyXG4gICAgdGhpcy5fbGlrZXMgPSBsaWtlcztcclxuICAgIHRoaXMuX3VwZGF0ZUxpa2VzVmlldygpO1xyXG4gIH1cclxuICBfdXBkYXRlTGlrZXNWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19udW1iZXJcIikudGV4dENvbnRlbnQgPVxyXG4gICAgICB0aGlzLl9saWtlcy5sZW5ndGg7XHJcblxyXG4gICAgLy8gIHRoYXQgZWRpdHMgdGhlIC50ZXh0Q29udGVudCBvZiB0aGUgc3BhbiB3aXRoIHRoZSBudW1iZXJcclxuICAgIC8vaW4gaXQgdG8gbWF0Y2ggaG93IG1hbnkgdGhpcy5fbGlrZXMgdGhlcmUgYXJlLFxyXG4gIH1cclxuXHJcbiAgaXNMaWtlZCgpIHtcclxuICAgIHJldHVybiB0aGlzLl9saWtlcy5zb21lKCgpID0+IHtcclxuICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlblVzZXJJZCA9PT0gdGhpcy5fbGlrZXMuX2lkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG4gIGhhbmRsZU1vZGFsRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG4gIGhhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX2RlbGV0ZUJ0biA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgY29uc29sZS5sb2codGhpcy5fdXNlcklkKTtcclxuICAgIGlmICh0aGlzLl9jdXJyZW50VXNlcklkICE9IHRoaXMuX3VzZXJJZCkge1xyXG4gICAgICB0aGlzLl9kZWxldGVCdG4ucmVtb3ZlKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gZG9jdW1lbnRcclxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxyXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcclxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldENhcmQoKSB7XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IHRoaXMuX2dldFRlbXBsYXRlKCk7XHJcbiAgICAvL2dldCB0aGUgY2FyZCB2aWV3XHJcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtaW1hZ2VcIikuc3JjID0gdGhpcy5fbGluaztcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1uYW1lXCIpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1pbWFnZVwiKS5hbHQgPSB0aGlzLl9uYW1lO1xyXG5cclxuICAgIHRoaXMuaGFuZGxlRGVsZXRlQnV0dG9uKCk7XHJcbiAgICAvL3NldCB0aGUgZXZlbnQgbGlzdGVuZXJzXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fdXBkYXRlTGlrZXNWaWV3KCk7XHJcblxyXG4gICAgLy9yZXR1cm4gdGhlIGNhcmRcclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuLy9fdXBkYXRlTGlrZXNWaWV3IGlzIGNhbGxlZCBpbiBnZXRWaWV3ICh3aGljaCByZXR1cm5zIHRoZSBjYXJkXHJcbi8vSFRNTCBpbml0aWFsbHkpLCBhbmQgaW4gc2V0TGlrZXNJbmZvIHdoaWNoIHVwZGF0ZXMgdGhlXHJcbi8vdGhpcy5fbGlrZXMgYXJyYXkgYmFzZWQgb24gdGhlIGFyZ3VtZW50cyBwYXNzZWQgaW50byBpdFxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uT3B0aW9ucywgZm9ybUVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Zvcm1TZWxlY3RvciA9IFwiLm1vZGFsX19mb3JtXCI7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gXCIubW9kYWxfX2lucHV0XCI7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IFwiLm1vZGFsX19idXR0b25cIjtcclxuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIjtcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIjtcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCI7XHJcblxyXG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xyXG5cclxuICAgIHRoaXMuX2lucHV0TGlzdCA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuXHJcbiAgICB0aGlzLl9zYXZlQnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxyXG4gICAgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICB0aGlzLl9lcnJvck1lc3NhZ2VFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zb2xlLmxvZyhgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIHRoaXMuX2Vycm9yTWVzc2FnZUVsZW1lbnQudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gICAgdGhpcy5fZXJyb3JNZXNzYWdlRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xyXG4gIH1cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoXHJcbiAgICAgIChpbnB1dEVsZW1lbnQpID0+IGlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZFxyXG4gICAgKTtcclxuICB9XHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoc2F2ZUJ1dHRvbiwgb3B0aW9ucykge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fc2F2ZUJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIHRoaXMuX3NhdmVCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3NhdmVCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcclxuICB9XHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xyXG4gICAgfVxyXG4gIH1cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XHJcbiAgICAgICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcclxuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfSk7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXIpIHtcclxuICAgIHRoaXMuaXRlbXMgPSBpdGVtcztcclxuICAgIHRoaXMucmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgdGhpcy5pdGVtcy5mb3JFYWNoKHRoaXMucmVuZGVyZXIpO1xyXG4gIH1cclxuXHJcbiAgYWRkSXRlbShpdGVtKSB7XHJcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChpdGVtKTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5tb2RhbENsb3NlQnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgIFwiI21vZGFsLWNsb3NlLWJ1dHRvblwiXHJcbiAgICApO1xyXG4gIH1cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgIGNvbnN0IEVTQ19LRVlDT0RFID0gMjc7XHJcbiAgICBpZiAoZXZ0LndoaWNoID09PSBFU0NfS0VZQ09ERSkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuIFxyXG5cclxuICBcclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5jbG9zZU1vZGFsT25SZW1vdGVDbGljayk7XHJcbiAgfVxyXG4gIGNsb3NlTW9kYWxPblJlbW90ZUNsaWNrID0gKGV2dCkgPT4ge1xyXG4gICAgaWYgKFxyXG4gICAgICBldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCB8fFxyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuY2xvc2UoZXZ0LnRhcmdldCk7XHJcbiAgICB9XHJcbiAgfTtcclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0IH0pIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX21vZGFsRm9ybSA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgfVxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICBjb25zdCBpbnB1dHMgPSB0aGlzLl9tb2RhbEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICBpbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgY29uc3QgbmFtZSA9IGlucHV0Lm5hbWU7XHJcbiAgICAgIGNvbnN0IHZhbHVlID0gaW5wdXQudmFsdWU7XHJcbiAgICAgIGlucHV0VmFsdWVzW25hbWVdID0gdmFsdWU7XHJcbiAgICB9KTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcbiAgc2V0TG9hZGluZyhpc0xvYWRpbmcpIHtcclxuICAgIGNvbnN0IG1vZGFsU3VibWl0QnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICAgIGlmIChpc0xvYWRpbmcpIHtcclxuICAgICAgbW9kYWxTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZ1wiO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgbW9kYWxTdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPVxyXG4gICAgICAgIG1vZGFsU3VibWl0QnV0dG9uLnRleHRDb250ZW50O1xyXG4gICAgfVxyXG4gIH1cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIC8vc3VibWl0IGV2ZW50XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHRoaXMuX21vZGFsRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fbW9kYWxGb3JtLnJlc2V0KCk7XHJcbiAgICBzdXBlci5jbG9zZSgpO1xyXG4gIH1cclxuXHJcbiAgc2V0U3VibWl0QWN0aW9uKGFjdGlvbikge1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGFjdGlvbjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBcIi4uL3BhZ2VzL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BUEkuanNcIjtcclxuXHJcbi8qY29uc3QgY2FyZERhdGEgPSB7XHJcbiAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWdvLmpwZyBcIixcclxufTsqL1xyXG5cclxuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcclxuY29uc3QgcHJvZmlsZU1vZGFsQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtbW9kYWwtY2xvc2UtYnV0dG9uXCJcclxuKTtcclxuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLXRpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlQWJvdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtYWJvdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsLXRpdGxlXCIpO1xyXG5jb25zdCBwcm9maWxlQWJvdXRJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtYWJvdXRcIik7XHJcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZUlucHV0ID1cclxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcclxuXHJcbmNvbnN0IGFkZENhcmRFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWVkaXQtbW9kYWxcIik7XHJcbmNvbnN0IGFkZENhcmRNb2RhbENsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNhZGQtY2FyZC1tb2RhbC1jbG9zZS1idXR0b25cIlxyXG4pO1xyXG5jb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWFkZC1idXR0b25cIik7XHJcbmNvbnN0IGFkZENhcmRUaXRsZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbC10aXRsZVwiKTtcclxuY29uc3QgYWRkQ2FyZExpbmtJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbGlua1wiKTtcclxuXHJcbmNvbnN0IGFkZENhcmRGb3JtID0gYWRkQ2FyZEVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsLWZvcm1cIik7XHJcbmNvbnN0IGNhcmRzV3JhcCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1saXN0XCIpO1xyXG5cclxuY29uc3QgaW1hZ2VNb2RhbENsb3NlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1jbG9zZS1idXR0b25cIik7XHJcbmNvbnN0IGRlbGV0ZUJ0bk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNtb2RhbC1kZWxldGVcIik7XHJcbmNvbnN0IHZhbGlkYXRpb25PcHRpb25zID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxufTtcclxuY29uc3QgcHJvZmlsZUltYWdlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZS1idXR0b25cIik7XHJcblxyXG5jb25zdCBwcm9maWxlSW1hZ2VTYXZlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uX3NhdmVcIik7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtcHJvZmlsZS1pbWFnZVwiKTtcclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICB2YWxpZGF0aW9uT3B0aW9ucyxcclxuICBwcm9maWxlRWRpdE1vZGFsXHJcbik7XHJcbmNvbnN0IGFkZENhcmRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgdmFsaWRhdGlvbk9wdGlvbnMsXHJcbiAgYWRkQ2FyZEVkaXRNb2RhbFxyXG4pO1xyXG5cclxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hZGRDYXJkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcblxyXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIucHJvZmlsZV9fdGl0bGVcIixcclxuICBhYm91dDogXCIucHJvZmlsZV9fYWJvdXRcIixcclxufSk7XHJcblxyXG5jb25zdCBlZGl0TW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlRWRpdE1vZGFsRm9ybVN1Ym1pdCxcclxufSk7XHJcbmVkaXRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XHJcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWNhcmQtZWRpdC1tb2RhbFwiLFxyXG4gIGhhbmRsZUZvcm1TdWJtaXQ6IGhhbmRsZUFkZENhcmRGb3JtU3VibWl0LFxyXG59KTtcclxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xyXG4gIHBvcHVwU2VsZWN0b3I6IFwiI2ltYWdlLW1vZGFsXCIsXHJcbn0pO1xyXG5pbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IGNhcmREZWxldGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNtb2RhbC1kZWxldGVcIixcclxuICBoYW5kbGVGb3JtU3VibWl0OiAoKSA9PiB7fSxcclxufSk7XHJcbmNhcmREZWxldGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5jb25zdCBwcm9maWxlSW1hZ2VNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcclxuICBwb3B1cFNlbGVjdG9yOiBcIiNtb2RhbC1wcm9maWxlLWltYWdlXCIsXHJcbiAgaGFuZGxlRm9ybVN1Ym1pdDogaGFuZGxlUHJvZmlsZUltYWdlRm9ybSxcclxufSk7XHJcbnByb2ZpbGVJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbmNvbnN0IHByb2ZpbGVJbWFnZVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIHZhbGlkYXRpb25PcHRpb25zLFxyXG4gIHByb2ZpbGVJbWFnZVxyXG4pO1xyXG5wcm9maWxlSW1hZ2VWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5wcm9maWxlSW1hZ2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBwcm9maWxlSW1hZ2VNb2RhbC5vcGVuKCk7XHJcbn0pO1xyXG5cclxucHJvZmlsZUltYWdlU2F2ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGhhbmRsZVByb2ZpbGVJbWFnZUZvcm0oKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBwcm9jZXNzTGlrZUNsaWNrKGNhcmQpIHtcclxuICBjb25zdCBpc0xpa2VkID0gY2FyZC5pc0xpa2VkKCk7XHJcbiAgY29uc29sZS5sb2coaXNMaWtlZCk7XHJcbiAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fYnV0dG9uX2FjdGl2ZVwiKTtcclxuICBpZiAoaXNMaWtlZCkge1xyXG4gICAgYXBpLnJlbW92ZUNhcmRMaWtlKGNhcmQuX2NhcmRJZCkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjYXJkLnNldExpa2VzSW5mbyhkYXRhLmxpa2VzKTtcclxuICAgIH0pO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBhcGkuYWRkQ2FyZExpa2UoY2FyZC5fY2FyZElkKS50aGVuKChkYXRhKSA9PiB7XHJcbiAgICAgIGNhcmQuc2V0TGlrZXNJbmZvKGRhdGEubGlrZXMpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcclxuICBjb25zdCBjYXJkID0gbmV3IENhcmQoe1xyXG4gICAgY2FyZERhdGEsXHJcbiAgICBjYXJkU2VsZWN0b3I6IFwiI2NhcmQtdGVtcGxhdGVcIixcclxuICAgIF9oYW5kbGVDYXJkQ2xpY2s6ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xyXG4gICAgICAvL2hlcmUgaXMgd2hlcmUgd2Ugd2FudCB0byBvcGVuIG91ciBwb3B1cFdpdGhJbWFnZSBpbnN0YW5jZS5cclxuICAgICAgaW1hZ2VNb2RhbC5vcGVuKHsgbmFtZSwgbGluayB9KTtcclxuICAgIH0sXHJcbiAgICBoYW5kbGVEZWxldGVDbGljazogKGNhcmRJZCkgPT4ge1xyXG4gICAgICAvLyBvcGVuIHRoZSBtb2RhbFxyXG4gICAgICBvcGVuRGVsZXRlTW9kYWwoKTtcclxuICAgICAgLy8gc2V0IGEgc3VibWl0IGFjdGlvblxyXG4gICAgICBjYXJkRGVsZXRlTW9kYWwuc2V0U3VibWl0QWN0aW9uKCgpID0+IHtcclxuICAgICAgICBhcGlcclxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJZClcclxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICAgICAgY2FyZERlbGV0ZU1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgICAgIGNhcmQuaGFuZGxlTW9kYWxEZWxldGVCdXR0b24oKTtcclxuICAgICAgICAgICAgY2FyZERlbGV0ZU1vZGFsLnNldExvYWRpbmcoZmFsc2UpO1xyXG4gICAgICAgICAgICBjbG9zZURlbGV0ZU1vZGFsKCk7XHJcbiAgICAgICAgICB9KVxyXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuICAgIHByb2Nlc3NMaWtlQ2xpY2ssXHJcblxyXG4gICAgdXNlcklkLFxyXG4gIH0pO1xyXG5cclxuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZC5nZXRDYXJkKCkpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUVkaXRNb2RhbEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcclxuICBlZGl0TW9kYWwuc2V0TG9hZGluZyh0cnVlKTtcclxuICBhcGkudXBkYXRlVXNlckluZm8oaW5wdXRWYWx1ZXMubmFtZSwgaW5wdXRWYWx1ZXMuYWJvdXQpLnRoZW4oKGRhdGEpID0+IHtcclxuICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKGRhdGEpO1xyXG4gICAgZWRpdE1vZGFsLmNsb3NlKCk7XHJcbiAgfSk7XHJcbiAgZWRpdE1vZGFsLnNldExvYWRpbmcoZmFsc2UpO1xyXG59XHJcbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGNhcmREYXRhKSB7XHJcbiAgYWRkQ2FyZE1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgYXBpXHJcbiAgICAuYWRkQ2FyZChjYXJkRGF0YSlcclxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICBhZGRDYXJkTW9kYWwuc2V0TG9hZGluZyhmYWxzZSk7XHJcbiAgICAgIHJlbmRlckNhcmQoY2FyZERhdGEpO1xyXG4gICAgICBhZGRDYXJkTW9kYWwuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUltYWdlRm9ybSgpIHtcclxuICAvL2V2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIHByb2ZpbGVJbWFnZU1vZGFsLnNldExvYWRpbmcodHJ1ZSk7XHJcbiAgY29uc3QgcHJvZmlsZUltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcclxuICBjb25zdCBwcm9maWxlSW1hZ2VJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1pbWFnZS1saW5rXCIpO1xyXG4gIHByb2ZpbGVJbWFnZS5zcmMgPSBwcm9maWxlSW1hZ2VJbnB1dC52YWx1ZTtcclxuICBwcm9maWxlSW1hZ2VNb2RhbC5zZXRMb2FkaW5nKGZhbHNlKTtcclxuICBhcGkudXBkYXRlUHJvZmlsZUltYWdlKCk7XHJcbiAgcHJvZmlsZUltYWdlTW9kYWwuY2xvc2UoKTtcclxufVxyXG5cclxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCBwcm9maWxlRGF0YSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBwcm9maWxlRGF0YS5uYW1lO1xyXG4gIHByb2ZpbGVBYm91dElucHV0LnZhbHVlID0gcHJvZmlsZURhdGEuYWJvdXQ7XHJcbiAgZWRpdE1vZGFsLm9wZW4oKTtcclxufSk7XHJcblxyXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgYWRkQ2FyZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICBhZGRDYXJkTW9kYWwub3BlbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMlwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTsgLy8gbG9nIHRoZSBlcnJvciB0byB0aGUgY29uc29sZVxyXG5cclxubGV0IHNlY3Rpb247XHJcbmxldCB1c2VySWQ7XHJcblxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlckRhdGFdKSA9PiB7XHJcbiAgICB1c2VySWQgPSB1c2VyRGF0YS5faWQ7XHJcbiAgICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXHJcbiAgICAgIHsgaXRlbXM6IGNhcmRzLCByZW5kZXJlcjogcmVuZGVyQ2FyZCB9LFxyXG4gICAgICBcIi5jYXJkc19fbGlzdFwiXHJcbiAgICApO1xyXG4gICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xyXG4gICAgdXNlckluZm8uc2V0VXNlckluZm8oe25hbWU6IHVzZXJEYXRhLm5hbWUsYWJvdXQ6IHVzZXJEYXRhLmFib3V0IH0pO1xyXG4gIH0pXHJcbiAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICB9KTtcclxuXHJcbm9wZW5Qcm9maWxlSW1hZ2VNb2RhbCgpO1xyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVJbWFnZU1vZGFsKCkge1xyXG4gIHByb2ZpbGVJbWFnZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgcHJvZmlsZUltYWdlTW9kYWwub3BlbigpO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBvcGVuRGVsZXRlTW9kYWwoKSB7XHJcbiAgZGVsZXRlQnRuTW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2xvc2VEZWxldGVNb2RhbCgpIHtcclxuICBkZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHRoaXMubmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XHJcbiAgICB0aGlzLmFib3V0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhYm91dCk7XHJcbiAgICBcclxuICB9XHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAvLyByZXR1cm4gdGhlIHRleHQgcHJvcGVydGllcyBvZiB0aGlzLm5hbWUgYW5kIHRoaXMuam9iXHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLm5hbWUudGV4dENvbnRlbnQsIGFib3V0OiB0aGlzLmFib3V0LnRleHRDb250ZW50LCB9O1xyXG4gIH1cclxuICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0LCB9KSB7XHJcbiAgICAvLyBXaGVuIGZvcm0gaXMgc3VibWl0dGVkLCBzZXQgdGhlIHByb2ZpbGUgaW5mb1xyXG4gICAgdGhpcy5uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuYWJvdXQudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICBcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciB9KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgfVxyXG4gIG9wZW4oY2FyZERhdGEpIHtcclxuICAgIGNvbnN0IGltYWdlTW9kYWxDYXJkID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtaW1hZ2VcIik7XHJcbiAgICBjb25zdCBpbWFnZU1vZGFsQ2FwdGlvbiA9XHJcbiAgICAgIHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWNhcHRpb25cIik7XHJcblxyXG4gICAgLypJbiB0aGUgb3BlbigpIG1ldGhvZCBvZiB0aGUgUG9wdXBXaXRoSW1hZ2UgY2xhc3MsIFxyXG4gICAgeW91IG5lZWQgdG8gYWRkIGFuIGltYWdlIHRvIHRoZSBwb3B1cCBhbmQgdGhlIFxyXG4gICAgY29ycmVzcG9uZGluZyBpbWFnZSBzcmMgYXR0cmlidXRlIGFsb25nIHdpdGggYSBcclxuICAgIGNhcHRpb24gZm9yIHRoZSBpbWFnZS4qL1xyXG4gICAgaW1hZ2VNb2RhbENhcHRpb24udGV4dENvbnRlbnQgPSBjYXJkRGF0YS5uYW1lO1xyXG4gICAgaW1hZ2VNb2RhbENhcmQuc3JjID0gY2FyZERhdGEubGluaztcclxuICAgIGltYWdlTW9kYWxDYXJkLmFsdCA9IGNhcmREYXRhLm5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsIi8qZmV0Y2goXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsIHtcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiXHJcbiAgfVxyXG59KVxyXG4gIC50aGVuKHJlcyA9PiByZXMuanNvbigpKVxyXG4gIC50aGVuKChyZXN1bHQpID0+IHtcclxuICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XHJcbiAgfSk7Ki9cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IobmFtZSwgbGluaykge1xyXG4gICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgIHRoaXMubGluayA9IGxpbms7XHJcbiAgfVxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzXCIsIHtcclxuICAgICAgbWV0aG9kOiBcIkdFVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCJiYjJmNWQ4Ni05MGNhLTQ0MWItOWFjOC1hMWVlMDIwNThkZjVcIixcclxuICAgICAgfSxcclxuICAgIH0pO1xyXG4gIH1cclxuICB1cGRhdGVQcm9maWxlSW1hZ2UoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcclxuICAgICAgXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL3VzZXJzL21lXCIsXHJcbiAgICAgIHtcclxuICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICBhdmF0YXI6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXHJcbiAgICAgICAgfSksXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFxyXG4gICAgICBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIixcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJHRVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcbiAgdXBkYXRlVXNlckluZm8obmFtZSwgYWJvdXQpIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFxyXG4gICAgICBcImh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvdXNlcnMvbWVcIixcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICB9LFxyXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgIG5hbWUsXHJcbiAgICAgICAgICBhYm91dCxcclxuICAgICAgICB9KSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGFkZENhcmQoeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KFwiaHR0cHM6Ly9hcm91bmQubm9tb3JlcGFydGllcy5jby92MS9ncm91cC0xMi9jYXJkc1wiLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZSxcclxuICAgICAgICBsaW5rLFxyXG4gICAgICB9KSxcclxuICAgIH0pO1xyXG4gIH1cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcclxuICAgICAgYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvJHtpZH1gLFxyXG4gICAgICB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcbiAgaGFuZGxlRGVsZXRlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtZGVsZXRlXCIpO1xyXG4gICAgdGhpcy5kZWxldGVCdG5Nb2RhbC5jbGFzc0xpc3QuYWRkKFwiLm1vZGFsX29wZW5lZFwiKTtcclxuICB9XHJcbiAgaGFuZGxlQ2FyZExpa2VzKCkge1xyXG4gICAgcmV0dXJuIFByb21pc2UuYWxsKFt0aGlzLmFkZENhcmRMaWtlKCksIHRoaXMucmVtb3ZlQ2FyZExpa2UoKV0pO1xyXG4gIH1cclxuICBhZGRDYXJkTGlrZShpZCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoXHJcbiAgICAgIGBodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2dyb3VwLTEyL2NhcmRzL2xpa2VzLyR7aWR9YCxcclxuICAgICAge1xyXG4gICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcImJiMmY1ZDg2LTkwY2EtNDQxYi05YWM4LWExZWUwMjA1OGRmNVwiLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfVxyXG4gIHJlbW92ZUNhcmRMaWtlKGlkKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChcclxuICAgICAgYGh0dHBzOi8vYXJvdW5kLm5vbW9yZXBhcnRpZXMuY28vdjEvZ3JvdXAtMTIvY2FyZHMvbGlrZXMvJHtpZH1gLFxyXG4gICAgICB7XHJcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAgIGF1dGhvcml6YXRpb246IFwiYmIyZjVkODYtOTBjYS00NDFiLTlhYzgtYTFlZTAyMDU4ZGY1XCIsXHJcbiAgICAgICAgfSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcbiAgLy8gb3RoZXIgbWV0aG9kcyBmb3Igd29ya2luZyB3aXRoIHRoZSBBUElcclxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcclxuICAgIGlmIChyZXMub2spIHtcclxuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yICR7SlNPTi5zdHJpbmdpZnkocmVzKX1gKTtcclxuICB9XHJcblxyXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xyXG4gICAgcmV0dXJuIGZldGNoKHVybCwgb3B0aW9ucykudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcclxuICB9XHJcbn1cclxuLyogSSB3ZW50IGJhY2sgdGhyb3VnaCB0aGUgaGlzdG9yeSB0byByZXZpZXcgeW91ciBjb21tZW50c1xyXG5pbiByZWdhcmRzIHRoZSBBUEkgYnV0IEkgY291bGRuJ3QgdmlldyB0aGUgY29tbWVudHMgc2luY2UgXHJcbkkgY2xlYXJlZCB0aGVtIG91dC4gIFRoZSBvbmx5IHJlYXNvbiBJIGNsZWFyZWQgdGhlbSBvdXRcclxuaXMgYmVjYXVzZSBJIHRob3VnaHQgSSBoYWQgY29ycmVjdGVkIGFsbCBvZiB0aGVtLiovIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkRGF0YSIsImNhcmRTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJoYW5kbGVEZWxldGVDbGljayIsInByb2Nlc3NMaWtlQ2xpY2siLCJ1c2VySWQiLCJ0aGlzIiwiX2NhcmRJZCIsIl9pZCIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9jYXJkU2VsZWN0b3IiLCJfY2FyZFRlbXBsYXRlSW5wdXQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJfY2FyZEVsZW1lbnQiLCJjbG9uZU5vZGUiLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfdXNlcklkIiwiX2N1cnJlbnRVc2VySWQiLCJvd25lciIsIl9wcm9jZXNzTGlrZUNsaWNrIiwiX21vZGFsRGVsZXRlQnV0dG9uIiwiX2xpa2VzIiwibGlrZXMiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfbGlrZUJ1dHRvbiIsImFkZEV2ZW50TGlzdGVuZXIiLCJfZGVsZXRlQnRuIiwic2V0TGlrZXNJbmZvIiwiX3VwZGF0ZUxpa2VzVmlldyIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiaXNMaWtlZCIsInNvbWUiLCJfY3VycmVuVXNlcklkIiwiaGFuZGxlTW9kYWxEZWxldGVCdXR0b24iLCJyZW1vdmUiLCJoYW5kbGVEZWxldGVCdXR0b24iLCJjb25zb2xlIiwibG9nIiwiX2dldFRlbXBsYXRlIiwiZ2V0Q2FyZCIsInNyYyIsImFsdCIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uT3B0aW9ucyIsImZvcm1FbGVtZW50IiwiX2Zvcm1TZWxlY3RvciIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfZm9ybSIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3NhdmVCdXR0b24iLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfZXJyb3JNZXNzYWdlRWxlbWVudCIsImlkIiwiY2xhc3NMaXN0IiwiYWRkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfaGFzSW52YWxpZElucHV0IiwiZXZlcnkiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJzYXZlQnV0dG9uIiwib3B0aW9ucyIsImRpc2FibGVkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsImZvckVhY2giLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiY29udGFpbmVyIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9jb250YWluZXIiLCJyZW5kZXJJdGVtcyIsImFkZEl0ZW0iLCJpdGVtIiwicHJlcGVuZCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJtb2RhbENsb3NlQnV0dG9uIiwib3BlbiIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIndoaWNoIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJjbG9zZU1vZGFsT25SZW1vdGVDbGljayIsInRhcmdldCIsImN1cnJlbnRUYXJnZXQiLCJjb250YWlucyIsIlBvcHVwV2l0aEZvcm0iLCJoYW5kbGVGb3JtU3VibWl0Iiwic3VwZXIiLCJfbW9kYWxGb3JtIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJzZXRMb2FkaW5nIiwiaXNMb2FkaW5nIiwibW9kYWxTdWJtaXRCdXR0b24iLCJyZXNldCIsInNldFN1Ym1pdEFjdGlvbiIsImFjdGlvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZUFib3V0SW5wdXQiLCJhZGRDYXJkRWRpdE1vZGFsIiwiYWRkQ2FyZEJ1dHRvbiIsImRlbGV0ZUJ0bk1vZGFsIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwcm9maWxlSW1hZ2VCdXR0b24iLCJwcm9maWxlSW1hZ2VTYXZlQnV0dG9uIiwicHJvZmlsZUltYWdlIiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRDYXJkRm9ybVZhbGlkYXRvciIsInVzZXJJbmZvIiwiYWJvdXQiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJlZGl0TW9kYWwiLCJhcGkiLCJ1cGRhdGVVc2VySW5mbyIsInRoZW4iLCJkYXRhIiwiYWRkQ2FyZE1vZGFsIiwiYWRkQ2FyZCIsInJlbmRlckNhcmQiLCJjYXRjaCIsImVyciIsImVycm9yIiwiaW1hZ2VNb2RhbCIsImltYWdlTW9kYWxDYXJkIiwiY2FyZERlbGV0ZU1vZGFsIiwicHJvZmlsZUltYWdlTW9kYWwiLCJoYW5kbGVQcm9maWxlSW1hZ2VGb3JtIiwiY2FyZCIsInRvZ2dsZSIsInJlbW92ZUNhcmRMaWtlIiwiYWRkQ2FyZExpa2UiLCJjYXJkSWQiLCJkZWxldGVDYXJkIiwicmVzIiwic2VjdGlvbiIsInByb2ZpbGVJbWFnZUlucHV0IiwidXBkYXRlUHJvZmlsZUltYWdlIiwicHJvZmlsZURhdGEiLCJnZXRBcHBJbmZvIiwiUHJvbWlzZSIsImFsbCIsImdldEluaXRpYWxDYXJkcyIsIl9yZXF1ZXN0IiwibWV0aG9kIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImF2YXRhciIsImhhbmRsZUNhcmRMaWtlcyIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwicmVqZWN0IiwidXJsIiwiZmV0Y2giLCJiYXNlVXJsIiwiY2FyZHMiLCJ1c2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=